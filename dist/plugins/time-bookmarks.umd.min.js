!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).TimeBookmarks={})}(this,(function(t){"use strict";var e=function(){if("undefined"!=typeof Map)return Map;function t(t,e){var n=-1;return t.some((function(t,r){return t[0]===e&&(n=r,!0)})),n}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var n=t(this.__entries__,e),r=this.__entries__[n];return r&&r[1]},e.prototype.set=function(e,n){var r=t(this.__entries__,e);~r?this.__entries__[r][1]=n:this.__entries__.push([e,n])},e.prototype.delete=function(e){var n=this.__entries__,r=t(n,e);~r&&n.splice(r,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var n=0,r=this.__entries__;n<r.length;n++){var i=r[n];t.call(e,i[1],i[0])}},e}()}(),n="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,r="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),i="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(r):function(t){return setTimeout((function(){return t(Date.now())}),1e3/60)};var s=["top","right","bottom","left","width","height","size","weight"],o="undefined"!=typeof MutationObserver,a=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var n=!1,r=!1,s=0;function o(){n&&(n=!1,t()),r&&u()}function a(){i(o)}function u(){var t=Date.now();if(n){if(t-s<2)return;r=!0}else n=!0,r=!1,setTimeout(a,e);s=t}return u}(this.refresh.bind(this),20)}return t.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},t.prototype.removeObserver=function(t){var e=this.observers_,n=e.indexOf(t);~n&&e.splice(n,1),!e.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},t.prototype.updateObservers_=function(){var t=this.observers_.filter((function(t){return t.gatherActive(),t.hasActive()}));return t.forEach((function(t){return t.broadcastActive()})),t.length>0},t.prototype.connect_=function(){n&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),o?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){n&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(t){var e=t.propertyName,n=void 0===e?"":e;s.some((function(t){return!!~n.indexOf(t)}))&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),u=function(t,e){for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];Object.defineProperty(t,i,{value:e[i],enumerable:!1,writable:!1,configurable:!0})}return t},l=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||r},h=y(0,0,0,0);function c(t){return parseFloat(t)||0}function f(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.reduce((function(e,n){return e+c(t["border-"+n+"-width"])}),0)}function d(t){var e=t.clientWidth,n=t.clientHeight;if(!e&&!n)return h;var r=l(t).getComputedStyle(t),i=function(t){for(var e={},n=0,r=["top","right","bottom","left"];n<r.length;n++){var i=r[n],s=t["padding-"+i];e[i]=c(s)}return e}(r),s=i.left+i.right,o=i.top+i.bottom,a=c(r.width),u=c(r.height);if("border-box"===r.boxSizing&&(Math.round(a+s)!==e&&(a-=f(r,"left","right")+s),Math.round(u+o)!==n&&(u-=f(r,"top","bottom")+o)),!function(t){return t===l(t).document.documentElement}(t)){var d=Math.round(a+s)-e,p=Math.round(u+o)-n;1!==Math.abs(d)&&(a-=d),1!==Math.abs(p)&&(u-=p)}return y(i.left,i.top,a,u)}var p="undefined"!=typeof SVGGraphicsElement?function(t){return t instanceof l(t).SVGGraphicsElement}:function(t){return t instanceof l(t).SVGElement&&"function"==typeof t.getBBox};function v(t){return n?p(t)?function(t){var e=t.getBBox();return y(0,0,e.width,e.height)}(t):d(t):h}function y(t,e,n,r){return{x:t,y:e,width:n,height:r}}var m=function(){function t(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=y(0,0,0,0),this.target=t}return t.prototype.isActive=function(){var t=v(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},t}(),g=function(t,e){var n,r,i,s,o,a,l,h=(r=(n=e).x,i=n.y,s=n.width,o=n.height,a="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,l=Object.create(a.prototype),u(l,{x:r,y:i,width:s,height:o,top:i,right:r+s,bottom:o+i,left:r}),l);u(this,{target:t,contentRect:h})},b=function(){function t(t,n,r){if(this.activeObservations_=[],this.observations_=new e,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=n,this.callbackCtx_=r}return t.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof l(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new m(t)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof l(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach((function(e){e.isActive()&&t.activeObservations_.push(e)}))},t.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map((function(t){return new g(t.target,t.broadcastRect())}));this.callback_.call(t,e,t),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),w="undefined"!=typeof WeakMap?new WeakMap:new e,_=function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=a.getInstance(),r=new b(e,n,this);w.set(this,r)};["observe","unobserve","disconnect"].forEach((function(t){_.prototype[t]=function(){var e;return(e=w.get(this))[t].apply(e,arguments)}}));void 0!==r.ResizeObserver&&r.ResizeObserver;var x="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function $(t,e,n){return t(n={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&n.path)}},n.exports),n.exports}function M(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})})),e}$((function(t,e){t.exports=function(){var t="millisecond",e="second",n="minute",r="hour",i="day",s="week",o="month",a="quarter",u="year",l="date",h=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d+)?$/,c=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,f=function(t,e,n){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(n)+t},d={s:f,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),i=n%60;return(e<=0?"+":"-")+f(r,2,"0")+":"+f(i,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),i=e.clone().add(r,o),s=n-i<0,a=e.clone().add(r+(s?-1:1),o);return+(-(r+(n-i)/(s?i-a:a-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(h){return{M:o,y:u,w:s,d:i,D:l,h:r,m:n,s:e,ms:t,Q:a}[h]||String(h||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},p={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},v="en",y={};y[v]=p;var m=function(t){return t instanceof _},g=function(t,e,n){var r;if(!t)return v;if("string"==typeof t)y[t]&&(r=t),e&&(y[t]=e,r=t);else{var i=t.name;y[i]=t,r=i}return!n&&r&&(v=r),r||!n&&v},b=function(t,e){if(m(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new _(n)},w=d;w.l=g,w.i=m,w.w=function(t,e){return b(t,{locale:e.$L,utc:e.$u,$offset:e.$offset})};var _=function(){function f(t){this.$L=this.$L||g(t.locale,null,!0),this.parse(t)}var d=f.prototype;return d.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(w.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(h);if(r){var i=r[2]-1||0,s=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)}}return new Date(e)}(t),this.init()},d.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},d.$utils=function(){return w},d.isValid=function(){return!("Invalid Date"===this.$d.toString())},d.isSame=function(t,e){var n=b(t);return this.startOf(e)<=n&&n<=this.endOf(e)},d.isAfter=function(t,e){return b(t)<this.startOf(e)},d.isBefore=function(t,e){return this.endOf(e)<b(t)},d.$g=function(t,e,n){return w.u(t)?this[e]:this.set(n,t)},d.unix=function(){return Math.floor(this.valueOf()/1e3)},d.valueOf=function(){return this.$d.getTime()},d.startOf=function(t,a){var h=this,c=!!w.u(a)||a,f=w.p(t),d=function(t,e){var n=w.w(h.$u?Date.UTC(h.$y,e,t):new Date(h.$y,e,t),h);return c?n:n.endOf(i)},p=function(t,e){return w.w(h.toDate()[t].apply(h.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(e)),h)},v=this.$W,y=this.$M,m=this.$D,g="set"+(this.$u?"UTC":"");switch(f){case u:return c?d(1,0):d(31,11);case o:return c?d(1,y):d(0,y+1);case s:var b=this.$locale().weekStart||0,_=(v<b?v+7:v)-b;return d(c?m-_:m+(6-_),y);case i:case l:return p(g+"Hours",0);case r:return p(g+"Minutes",1);case n:return p(g+"Seconds",2);case e:return p(g+"Milliseconds",3);default:return this.clone()}},d.endOf=function(t){return this.startOf(t,!1)},d.$set=function(s,a){var h,c=w.p(s),f="set"+(this.$u?"UTC":""),d=(h={},h[i]=f+"Date",h[l]=f+"Date",h[o]=f+"Month",h[u]=f+"FullYear",h[r]=f+"Hours",h[n]=f+"Minutes",h[e]=f+"Seconds",h[t]=f+"Milliseconds",h)[c],p=c===i?this.$D+(a-this.$W):a;if(c===o||c===u){var v=this.clone().set(l,1);v.$d[d](p),v.init(),this.$d=v.set(l,Math.min(this.$D,v.daysInMonth())).$d}else d&&this.$d[d](p);return this.init(),this},d.set=function(t,e){return this.clone().$set(t,e)},d.get=function(t){return this[w.p(t)]()},d.add=function(t,a){var l,h=this;t=Number(t);var c=w.p(a),f=function(e){var n=b(h);return w.w(n.date(n.date()+Math.round(e*t)),h)};if(c===o)return this.set(o,this.$M+t);if(c===u)return this.set(u,this.$y+t);if(c===i)return f(1);if(c===s)return f(7);var d=(l={},l[n]=6e4,l[r]=36e5,l[e]=1e3,l)[c]||1,p=this.$d.getTime()+t*d;return w.w(p,this)},d.subtract=function(t,e){return this.add(-1*t,e)},d.format=function(t){var e=this;if(!this.isValid())return"Invalid Date";var n=t||"YYYY-MM-DDTHH:mm:ssZ",r=w.z(this),i=this.$locale(),s=this.$H,o=this.$m,a=this.$M,u=i.weekdays,l=i.months,h=function(t,r,i,s){return t&&(t[r]||t(e,n))||i[r].substr(0,s)},f=function(t){return w.s(s%12||12,t,"0")},d=i.meridiem||function(t,e,n){var r=t<12?"AM":"PM";return n?r.toLowerCase():r},p={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:w.s(a+1,2,"0"),MMM:h(i.monthsShort,a,l,3),MMMM:h(l,a),D:this.$D,DD:w.s(this.$D,2,"0"),d:String(this.$W),dd:h(i.weekdaysMin,this.$W,u,2),ddd:h(i.weekdaysShort,this.$W,u,3),dddd:u[this.$W],H:String(s),HH:w.s(s,2,"0"),h:f(1),hh:f(2),a:d(s,o,!0),A:d(s,o,!1),m:String(o),mm:w.s(o,2,"0"),s:String(this.$s),ss:w.s(this.$s,2,"0"),SSS:w.s(this.$ms,3,"0"),Z:r};return n.replace(c,(function(t,e){return e||p[t]||r.replace(":","")}))},d.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},d.diff=function(t,l,h){var c,f=w.p(l),d=b(t),p=6e4*(d.utcOffset()-this.utcOffset()),v=this-d,y=w.m(this,d);return y=(c={},c[u]=y/12,c[o]=y,c[a]=y/3,c[s]=(v-p)/6048e5,c[i]=(v-p)/864e5,c[r]=v/36e5,c[n]=v/6e4,c[e]=v/1e3,c)[f]||v,h?y:w.a(y)},d.daysInMonth=function(){return this.endOf(o).$D},d.$locale=function(){return y[this.$L]},d.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=g(t,e,!0);return r&&(n.$L=r),n},d.clone=function(){return w.w(this.$d,this)},d.toDate=function(){return new Date(this.valueOf())},d.toJSON=function(){return this.isValid()?this.toISOString():null},d.toISOString=function(){return this.$d.toISOString()},d.toString=function(){return this.$d.toUTCString()},f}(),x=_.prototype;return b.prototype=x,[["$ms",t],["$s",e],["$m",n],["$H",r],["$W",i],["$M",o],["$y",u],["$D",l]].forEach((function(t){x[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),b.extend=function(t,e){return t(e,_,b),b},b.locale=g,b.isDayjs=m,b.unix=function(t){return b(1e3*t)},b.en=y[v],b.Ls=y,b}()})),$((function(t,e){t.exports=function(t,e,n){var r=(new Date).getTimezoneOffset(),i=e.prototype;n.utc=function(t){return new e({date:t,utc:!0,args:arguments})},i.utc=function(){return n(this.toDate(),{locale:this.$L,utc:!0})},i.local=function(){return n(this.toDate(),{locale:this.$L,utc:!1})};var s=i.parse;i.parse=function(t){t.utc&&(this.$u=!0),this.$utils().u(t.$offset)||(this.$offset=t.$offset),s.call(this,t)};var o=i.init;i.init=function(){if(this.$u){var t=this.$d;this.$y=t.getUTCFullYear(),this.$M=t.getUTCMonth(),this.$D=t.getUTCDate(),this.$W=t.getUTCDay(),this.$H=t.getUTCHours(),this.$m=t.getUTCMinutes(),this.$s=t.getUTCSeconds(),this.$ms=t.getUTCMilliseconds()}else o.call(this)};var a=i.utcOffset;i.utcOffset=function(t,e){var n=this.$utils().u;if(n(t))return this.$u?0:n(this.$offset)?a.call(this):this.$offset;var i=Math.abs(t)<=16?60*t:t,s=this;return e?(s.$offset=i,s.$u=0===t,s):(0!==t?(s=this.local().add(i+r,"minute")).$offset=i:s=this.utc(),s)};var u=i.format;i.format=function(t){var e=t||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return u.call(this,e)},i.valueOf=function(){var t=this.$utils().u(this.$offset)?0:this.$offset+r;return this.$d.valueOf()-6e4*t},i.isUTC=function(){return!!this.$u},i.toISOString=function(){return this.toDate().toISOString()},i.toString=function(){return this.toDate().toUTCString()};var l=i.toDate;i.toDate=function(t){return"s"===t&&this.$offset?n(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():l.call(this)};var h=i.diff;i.diff=function(t,e,r){var i=this.local(),s=n(t).local();return h.call(i,s,e,r)}}}));var O=$((function(t,e){function n(t,e){void 0===e&&(e="*"),this.wchar=e,this.pattern=t,this.segments=[],this.starCount=0,this.minLength=0,this.maxLength=0,this.segStartIndex=0;for(var n=0,r=t.length;n<r;n+=1){var i=t[n];i===e&&(this.starCount+=1,n>this.segStartIndex&&this.segments.push(t.substring(this.segStartIndex,n)),this.segments.push(i),this.segStartIndex=n+1)}this.segStartIndex<t.length&&this.segments.push(t.substring(this.segStartIndex)),this.starCount?(this.minLength=t.length-this.starCount,this.maxLength=1/0):this.maxLength=this.minLength=t.length}e.__esModule=!0,n.prototype.match=function(t){if(this.pattern===this.wchar)return!0;if(0===this.segments.length)return this.pattern===t;var e=t.length;if(e<this.minLength||e>this.maxLength)return!1;for(var n=this.segments.length-1,r=t.length-1,i=!1;;){var s=this.segments[n];if(n-=1,s===this.wchar)i=!0;else{var o=r+1-s.length,a=t.lastIndexOf(s,o);if(-1===a||a>o)return!1;if(i)r=a-1,i=!1;else{if(a!==o)return!1;r-=s.length}}if(0>n)break}return!0},e.default=n})),S=$((function(t,e){var n=x&&x.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};function r(t,e,n,r){void 0===r&&(r=void 0),this.obj=t,this.delimeter=e,this.wildcard=n,this.is_match=r}e.__esModule=!0,r.prototype.simpleMatch=function(t,e){if(t===e)return!0;if(t===this.wildcard)return!0;if(this.is_match)return this.is_match(t,e);var n=t.indexOf(this.wildcard);if(n>-1){var r=t.substr(n+1);if(0===n||e.substring(0,n)===t.substring(0,n)){var i=r.length;return!(i>0)||e.substr(-i)===r}}return!1},r.prototype.match=function(t,e){return this.is_match?this.is_match(t,e):t===e||t===this.wildcard||e===this.wildcard||this.simpleMatch(t,e)||new O.default(t).match(e)},r.prototype.handleArray=function(t,e,r,i,s){var o,a;void 0===s&&(s={});var u=t.indexOf(this.delimeter,r),l=!1;-1===u&&(l=!0,u=t.length);var h=t.substring(r,u),c=0;try{for(var f=n(e),d=f.next();!d.done;d=f.next()){var p=d.value,v=c.toString(),y=""===i?v:i+this.delimeter+c;(h===this.wildcard||h===v||this.simpleMatch(h,v))&&(l?s[y]=p:this.goFurther(t,p,u+1,y,s)),c++}}catch(t){o={error:t}}finally{try{d&&!d.done&&(a=f.return)&&a.call(f)}finally{if(o)throw o.error}}return s},r.prototype.handleObject=function(t,e,n,r,i){void 0===i&&(i={});var s=t.indexOf(this.delimeter,n),o=!1;-1===s&&(o=!0,s=t.length);var a=t.substring(n,s);for(var u in e){u=u.toString();var l=""===r?u:r+this.delimeter+u;(a===this.wildcard||a===u||this.simpleMatch(a,u))&&(o?i[l]=e[u]:this.goFurther(t,e[u],s+1,l,i))}return i},r.prototype.goFurther=function(t,e,n,r,i){return void 0===i&&(i={}),Array.isArray(e)?this.handleArray(t,e,n,r,i):this.handleObject(t,e,n,r,i)},r.prototype.get=function(t){return this.goFurther(t,this.obj,0,"")},e.default=r})),L=$((function(t,e){var n=x&&x.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};e.__esModule=!0;var r=function(){function t(){}return t.get=function(t,e,r){var i,s;if(void 0===r&&(r=!1),e){var o=e;try{for(var a=n(t),u=a.next();!u.done;u=a.next()){var l=u.value;if(o.hasOwnProperty(l))o=o[l];else{if(!r)return;o[l]={},o=o[l]}}}catch(t){i={error:t}}finally{try{u&&!u.done&&(s=a.return)&&s.call(a)}finally{if(i)throw i.error}}return o}},t.set=function(e,n,r){if(r){if(0!==e.length){var i=e.slice(),s=i.pop(),o=t.get(i,r,!0);return"object"==typeof o&&(o[s]=n),n}for(var a in n)r[a]=n[a]}},t}();e.default=r}));let D,P=0,R=null;function C(){return null!==R&&R.buffer===D.memory.buffer||(R=new Uint8Array(D.memory.buffer)),R}let I=new TextEncoder("utf-8");const E="function"==typeof I.encodeInto?function(t,e){return I.encodeInto(t,e)}:function(t,e){const n=I.encode(t);return e.set(n),{read:t.length,written:n.length}};function T(t,e,n){if(void 0===n){const n=I.encode(t),r=e(n.length);return C().subarray(r,r+n.length).set(n),P=n.length,r}let r=t.length,i=e(r);const s=C();let o=0;for(;o<r;o++){const e=t.charCodeAt(o);if(e>127)break;s[i+o]=e}if(o!==r){0!==o&&(t=t.slice(o)),i=n(i,r,r=o+3*t.length);const e=C().subarray(i+o,i+r);o+=E(t,e).written}return P=o,i}var N=M(Object.freeze({__proto__:null,is_match:function(t,e){var n=T(t,D.__wbindgen_malloc,D.__wbindgen_realloc),r=P,i=T(e,D.__wbindgen_malloc,D.__wbindgen_realloc),s=P;return 0!==D.is_match(n,r,i,s)},default:async function t(e){("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:r}=await async function(t,e){if("function"==typeof Response&&t instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(t,e)}catch(e){if("application/wasm"==t.headers.get("Content-Type"))throw e;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",e)}const n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}{const n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}(await e,{});return D=n.exports,t.__wbindgen_wasm_module=r,D}}));$((function(t,e){var n=x&&x.__assign||function(){return(n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},r=x&&x.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,a)}u((r=r.apply(t,e||[])).next())}))},i=x&&x.__generator||function(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},s=x&&x.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},o=x&&x.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o},a=x&&x.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t};function u(t,e){console.debug(t,e)}e.__esModule=!0;var l={bulk:!1,debug:!1,source:"",data:void 0,queue:!1},h={only:[],source:"",debug:!1,data:void 0,queue:!1,force:!1},c=function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e={}),this.jobsRunning=0,this.updateQueue=[],this.subscribeQueue=[],this.listenersIgnoreCache=new WeakMap,this.destroyed=!1,this.queueRuns=0,this.lastExecs=new WeakMap,this.listeners=new Map,this.waitingListeners=new Map,this.data=t,this.options=n({},{delimiter:".",useMute:!0,notRecursive:";",param:":",wildcard:"*",experimentalMatch:!1,queue:!1,maxSimultaneousJobs:1e3,maxQueueRuns:1e3,log:u,Promise:Promise},e),this.id=0,this.pathGet=L.default.get,this.pathSet=L.default.set,e.Promise?this.resolved=e.Promise.resolve():this.resolved=Promise.resolve(),this.muted=new Set,this.scan=new S.default(this.data,this.options.delimiter,this.options.wildcard),this.destroyed=!1}return t.prototype.loadWasmMatcher=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,N.default(t)];case 1:return e.sent(),this.is_match=N.is_match,this.scan=new S.default(this.data,this.options.delimiter,this.options.wildcard,this.is_match),[2]}}))}))},t.prototype.same=function(t,e){return(["number","string","undefined","boolean"].includes(typeof t)||null===t)&&e===t},t.prototype.getListeners=function(){return this.listeners},t.prototype.destroy=function(){this.destroyed=!0,this.data=void 0,this.listeners=new Map,this.updateQueue=[],this.jobsRunning=0},t.prototype.match=function(t,e){return this.is_match?this.is_match(t,e):t===e||(t===this.options.wildcard||e===this.options.wildcard||this.scan.match(t,e))},t.prototype.getIndicesOf=function(t,e){var n=t.length;if(0==n)return[];for(var r,i=0,s=[];(r=e.indexOf(t,i))>-1;)s.push(r),i=r+n;return s},t.prototype.getIndicesCount=function(t,e){var n=t.length;if(0==n)return 0;for(var r,i=0,s=0;(r=e.indexOf(t,i))>-1;)s++,i=r+n;return s},t.prototype.cutPath=function(t,e){t=this.cleanNotRecursivePath(t),e=this.cleanNotRecursivePath(e);var n=this.getIndicesCount(this.options.delimiter,e),r=this.getIndicesOf(this.options.delimiter,t);return t.substr(0,r[n])},t.prototype.trimPath=function(t){return(t=this.cleanNotRecursivePath(t)).charAt(0)===this.options.delimiter?t.substr(1):t},t.prototype.split=function(t){return""===t?[]:t.split(this.options.delimiter)},t.prototype.isWildcard=function(t){return t.includes(this.options.wildcard)||this.hasParams(t)},t.prototype.isNotRecursive=function(t){return t.endsWith(this.options.notRecursive)},t.prototype.cleanNotRecursivePath=function(t){return this.isNotRecursive(t)?t.substring(0,t.length-1):t},t.prototype.hasParams=function(t){return t.includes(this.options.param)},t.prototype.getParamsInfo=function(t){var e,n,r={replaced:"",original:t,params:{}},i=0,o=[];try{for(var a=s(this.split(t)),u=a.next();!u.done;u=a.next()){var l=u.value;r.params[i]={original:l,replaced:"",name:""};var h=new RegExp("\\"+this.options.param+"([^\\"+this.options.delimiter+"\\"+this.options.param+"]+)","g"),c=h.exec(l);c?(r.params[i].name=c[1],h.lastIndex=0,r.params[i].replaced=l.replace(h,this.options.wildcard),o.push(r.params[i].replaced),i++):(delete r.params[i],o.push(l),i++)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return r.replaced=o.join(this.options.delimiter),r},t.prototype.getParams=function(t,e){if(t){var n=this.split(e),r={};for(var i in t.params){r[t.params[i].name]=n[i]}return r}},t.prototype.waitForAll=function(t,e){var n,r,i={};try{for(var o=s(t),a=o.next();!a.done;a=o.next()){var u=a.value;i[u]={dirty:!1},this.hasParams(u)&&(i[u].paramsInfo=this.getParamsInfo(u)),i[u].isWildcard=this.isWildcard(u),i[u].isRecursive=!this.isNotRecursive(u)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return this.waitingListeners.set(t,{fn:e,paths:i}),e(i),function(){this.waitingListeners.delete(t)}},t.prototype.executeWaitingListeners=function(t){var e,n;if(!this.destroyed)try{for(var r=s(this.waitingListeners.values()),i=r.next();!i.done;i=r.next()){var o=i.value,a=o.fn,u=o.paths,l=0,h=0;for(var c in u){var f=u[c],d=!1;f.isRecursive&&(t=this.cutPath(t,c)),f.isWildcard&&this.match(c,t)&&(d=!0),t===c&&(d=!0),d&&(f.dirty=!0),f.dirty&&l++,h++}l===h&&a(u)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.subscribeAll=function(t,e,n){var r,i;if(void 0===n&&(n=l),this.destroyed)return function(){};var o=[];try{for(var a=s(t),u=a.next();!u.done;u=a.next()){var h=u.value;o.push(this.subscribe(h,e,n))}}catch(t){r={error:t}}finally{try{u&&!u.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return function(){var t,e;try{for(var n=s(o),r=n.next();!r.done;r=n.next()){(0,r.value)()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}}},t.prototype.getCleanListenersCollection=function(t){return void 0===t&&(t={}),n({listeners:new Map,isRecursive:!1,isWildcard:!1,hasParams:!1,match:void 0,paramsInfo:void 0,path:void 0,originalPath:void 0,count:0},t)},t.prototype.getCleanListener=function(t,e){return void 0===e&&(e=l),{fn:t,options:n({},l,e)}},t.prototype.getListenerCollectionMatch=function(t,e,n){t=this.cleanNotRecursivePath(t);var r=this;return function(i){return e&&(i=r.cutPath(i,t)),!(!n||!r.match(t,i))||t===i}},t.prototype.getListenersCollection=function(t,e){if(this.listeners.has(t)){var r=this.listeners.get(t);return r.listeners.set(++this.id,e),r}var i,s=this.hasParams(t);s&&(i=this.getParamsInfo(t));var o={isRecursive:!this.isNotRecursive(t),isWildcard:this.isWildcard(t),hasParams:s,paramsInfo:i,originalPath:t,path:s?i.replaced:t},a=this.getCleanListenersCollection(n({},o,{match:this.getListenerCollectionMatch(o.path,o.isRecursive,o.isWildcard)}));return this.id++,a.listeners.set(this.id,e),this.listeners.set(o.originalPath,a),a},t.prototype.subscribe=function(t,e,n,r){if(void 0===n&&(n=l),void 0===r&&(r="subscribe"),this.destroyed)return function(){};this.jobsRunning++;var i=this.getCleanListener(e,n);this.listenersIgnoreCache.set(i,{truthy:[],falsy:[]});var s=this.getListenersCollection(t,i);s.count++;var o=this.cleanNotRecursivePath(s.path);if(s.isWildcard){var a=this.scan.get(o);if(n.bulk){var u=[];for(var h in a)this.isMuted(h)||u.push({path:h,params:this.getParams(s.paramsInfo,h),value:a[h]});e(u,{type:r,listener:i,listenersCollection:s,path:{listener:t,update:void 0,resolved:void 0},options:n,params:void 0})}else for(var h in a)this.isMuted(h)||e(a[h],{type:r,listener:i,listenersCollection:s,path:{listener:t,update:void 0,resolved:this.cleanNotRecursivePath(h)},params:this.getParams(s.paramsInfo,h),options:n})}else this.isMuted(o)||e(this.pathGet(this.split(o),this.data),{type:r,listener:i,listenersCollection:s,path:{listener:t,update:void 0,resolved:this.cleanNotRecursivePath(t)},params:this.getParams(s.paramsInfo,o),options:n});return this.debugSubscribe(i,s,t),this.jobsRunning--,this.unsubscribe(t,this.id)},t.prototype.unsubscribe=function(t,e){var n=this.listeners,r=n.get(t);return function(){r.listeners.delete(e),r.count--,0===r.count&&n.delete(t)}},t.prototype.runQueuedListeners=function(){var t=this;if(!this.destroyed&&0!==this.subscribeQueue.length)if(0===this.jobsRunning){this.queueRuns=0;for(var e=a(this.subscribeQueue),n=0,r=e.length;n<r;n++)e[n]();this.subscribeQueue.length=0}else{if(this.queueRuns++,this.queueRuns>=this.options.maxQueueRuns)throw this.queueRuns=0,new Error("Maximal number of queue runs exhausted.");Promise.resolve().then((function(){return t.runQueuedListeners()})).catch((function(t){throw t}))}},t.prototype.notifyListeners=function(t,e,r){var i,o,a,u,l=this;void 0===e&&(e=[]),void 0===r&&(r=!0);var h=[];for(var c in t)if(!this.isMuted(c)){var f=t[c],d=f.single,p=f.bulk,v=function(t){if(e.includes(t))return"continue";var n=y.debugTime(t);t.listener.options.queue&&y.jobsRunning?y.subscribeQueue.push((function(){t.listener.fn(t.value(),t.eventInfo)})):t.listener.fn(t.value(),t.eventInfo),r&&h.push(t),y.debugListener(n,t)},y=this;try{for(var m=(i=void 0,s(d)),g=m.next();!g.done;g=m.next()){v(g.value)}}catch(t){i={error:t}}finally{try{g&&!g.done&&(o=m.return)&&o.call(m)}finally{if(i)throw i.error}}var b=function(t){var i,o;if(e.includes(t))return"continue";var a=w.debugTime(t),u=[];try{for(var c=(i=void 0,s(t.value)),f=c.next();!f.done;f=c.next()){var d=f.value;u.push(n({},d,{value:d.value()}))}}catch(t){i={error:t}}finally{try{f&&!f.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}t.listener.options.queue&&w.jobsRunning?w.subscribeQueue.push((function(){return!l.jobsRunning&&(t.listener.fn(u,t.eventInfo),!0)})):t.listener.fn(u,t.eventInfo),r&&h.push(t),w.debugListener(a,t)},w=this;try{for(var _=(a=void 0,s(p)),x=_.next();!x.done;x=_.next()){b(x.value)}}catch(t){a={error:t}}finally{try{x&&!x.done&&(u=_.return)&&u.call(_)}finally{if(a)throw a.error}}}return Promise.resolve().then((function(){return l.runQueuedListeners()})),h},t.prototype.shouldIgnore=function(t,e){var n,r;if(!t.options.ignore)return!1;try{for(var i=s(t.options.ignore),o=i.next();!o.done;o=i.next()){var a=o.value;if(e.startsWith(a))return!0;if(this.is_match&&this.is_match(a,e))return!0;var u=this.cutPath(e,a);if(this.match(a,u))return!0}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return!1},t.prototype.getSubscribedListeners=function(t,e,r,i,a){var u,l,c=this;void 0===i&&(i="update"),void 0===a&&(a=null),r=n({},h,r);var f={},d=function(n,o){var u,l;if(f[n]={single:[],bulk:[],bulkData:[]},o.match(t)){var h=o.paramsInfo?p.getParams(o.paramsInfo,t):void 0,d=p.cutPath(t,n),v=o.isRecursive||o.isWildcard?function(){return c.get(d)}:function(){return e},y=[{value:v,path:t,params:h}];try{for(var m=(u=void 0,s(o.listeners.values())),g=m.next();!g.done;g=m.next()){var b=g.value;p.shouldIgnore(b,t)||(b.options.bulk?f[n].bulk.push({listener:b,listenersCollection:o,eventInfo:{type:i,listener:b,path:{listener:n,update:a||t,resolved:void 0},params:h,options:r},value:y}):f[n].single.push({listener:b,listenersCollection:o,eventInfo:{type:i,listener:b,path:{listener:n,update:a||t,resolved:p.cleanNotRecursivePath(t)},params:h,options:r},value:v}))}}catch(t){u={error:t}}finally{try{g&&!g.done&&(l=m.return)&&l.call(m)}finally{if(u)throw u.error}}}},p=this;try{for(var v=s(this.listeners),y=v.next();!y.done;y=v.next()){var m=o(y.value,2);d(m[0],m[1])}}catch(t){u={error:t}}finally{try{y&&!y.done&&(l=v.return)&&l.call(v)}finally{if(u)throw u.error}}return f},t.prototype.notifySubscribedListeners=function(t,e,n,r,i){return void 0===r&&(r="update"),void 0===i&&(i=null),this.notifyListeners(this.getSubscribedListeners(t,e,n,r,i))},t.prototype.getNestedListeners=function(t,e,n,r,i){var a,u;void 0===r&&(r="update"),void 0===i&&(i=null);var l={},h=function(a,u){l[a]={single:[],bulk:[]};var h=c.cutPath(a,t);if(c.match(h,t)){var f=c.trimPath(a.substr(h.length)),d=new S.default(e,c.options.delimiter,c.options.wildcard).get(f),p=u.paramsInfo?c.getParams(u.paramsInfo,t):void 0,v=[],y={},m=function(e){var h,f,m=function(){return d[e]},g=[t,e].join(c.options.delimiter);try{for(var b=(h=void 0,s(u.listeners)),w=b.next();!w.done;w=b.next()){var _=o(w.value,2),x=_[0],$=_[1],M={type:r,listener:$,listenersCollection:u,path:{listener:a,update:i||t,resolved:c.cleanNotRecursivePath(g)},params:p,options:n};c.shouldIgnore($,t)||($.options.bulk?(v.push({value:m,path:g,params:p}),y[x]=$):l[a].single.push({listener:$,listenersCollection:u,eventInfo:M,value:m}))}}catch(t){h={error:t}}finally{try{w&&!w.done&&(f=b.return)&&f.call(b)}finally{if(h)throw h.error}}};for(var g in d)m(g);for(var b in y){var w=y[b],_={type:r,listener:w,listenersCollection:u,path:{listener:a,update:t,resolved:void 0},options:n,params:p};l[a].bulk.push({listener:w,listenersCollection:u,eventInfo:_,value:v})}}},c=this;try{for(var f=s(this.listeners),d=f.next();!d.done;d=f.next()){var p=o(d.value,2);h(p[0],p[1])}}catch(t){a={error:t}}finally{try{d&&!d.done&&(u=f.return)&&u.call(f)}finally{if(a)throw a.error}}return l},t.prototype.notifyNestedListeners=function(t,e,n,r,i,s){return void 0===r&&(r="update"),void 0===s&&(s=null),this.notifyListeners(this.getNestedListeners(t,e,n,r,s),i,!1)},t.prototype.getNotifyOnlyListeners=function(t,e,n,r,i){var a,u;void 0===r&&(r="update"),void 0===i&&(i=null);var l={};if("object"!=typeof n.only||!Array.isArray(n.only)||void 0===n.only[0]||!this.canBeNested(e))return l;var h=function(a){var u=new S.default(e,c.options.delimiter,c.options.wildcard).get(a);l[a]={bulk:[],single:[]};var h=function(e){var h,f,d,p,v=t+c.options.delimiter+e;try{for(var y=(h=void 0,s(c.listeners)),m=y.next();!m.done;m=y.next()){var g=o(m.value,2),b=g[0],w=g[1],_=w.paramsInfo?c.getParams(w.paramsInfo,v):void 0;if(c.match(b,v)){var x=function(){return u[e]},$=[{value:x,path:v,params:_}],M=function(e){var s={type:r,listener:e,listenersCollection:w,path:{listener:b,update:i||t,resolved:c.cleanNotRecursivePath(v)},params:_,options:n};if(c.shouldIgnore(e,t))return"continue";e.options.bulk?l[a].bulk.some((function(t){return t.listener===e}))||l[a].bulk.push({listener:e,listenersCollection:w,eventInfo:s,value:$}):l[a].single.push({listener:e,listenersCollection:w,eventInfo:s,value:x})};try{for(var O=(d=void 0,s(w.listeners.values())),S=O.next();!S.done;S=O.next()){M(S.value)}}catch(t){d={error:t}}finally{try{S&&!S.done&&(p=O.return)&&p.call(O)}finally{if(d)throw d.error}}}}}catch(t){h={error:t}}finally{try{m&&!m.done&&(f=y.return)&&f.call(y)}finally{if(h)throw h.error}}};for(var f in u)h(f)},c=this;try{for(var f=s(n.only),d=f.next();!d.done;d=f.next()){h(d.value)}}catch(t){a={error:t}}finally{try{d&&!d.done&&(u=f.return)&&u.call(f)}finally{if(a)throw a.error}}return l},t.prototype.notifyOnly=function(t,e,n,r,i){return void 0===r&&(r="update"),void 0===i&&(i=""),void 0!==this.notifyListeners(this.getNotifyOnlyListeners(t,e,n,r,i))[0]},t.prototype.canBeNested=function(t){return"object"==typeof t&&null!==t},t.prototype.getUpdateValues=function(t,e,n){var r=n;return"function"==typeof n&&(r=n(this.pathGet(e,this.data))),{newValue:r,oldValue:t}},t.prototype.wildcardNotify=function(t,e){var n,r,i,o,a,u,l=[];try{for(var h=s(t),c=h.next();!c.done;c=h.next()){var f=c.value,d=this.notifyListeners(f,l);try{for(var p=(i=void 0,s(d)),v=p.next();!v.done;v=p.next()){var y=v.value;l.push(y)}}catch(t){i={error:t}}finally{try{v&&!v.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}try{for(var m=s(e),g=m.next();!g.done;g=m.next()){var b=g.value;this.executeWaitingListeners(b)}}catch(t){a={error:t}}finally{try{g&&!g.done&&(u=m.return)&&u.call(m)}finally{if(a)throw a.error}}this.jobsRunning--},t.prototype.wildcardUpdate=function(t,e,r,i){void 0===r&&(r=h),void 0===i&&(i=!1),++this.jobsRunning,r=n({},h,r);var s=this.scan.get(t),o={};for(var a in s){var u=this.split(a),l=this.getUpdateValues(s[a],u,e),c=l.oldValue,f=l.newValue;this.same(f,c)&&!r.force||(this.pathSet(u,f,this.data),o[a]=f)}var d=[],p=[];for(var a in o){f=o[a];r.only.length?d.push(this.getNotifyOnlyListeners(a,f,r,"update",t)):(d.push(this.getSubscribedListeners(a,f,r,"update",t)),this.canBeNested(f)&&d.push(this.getNestedListeners(a,f,r,"update",t))),r.debug&&this.options.log("Wildcard update",{path:a,newValue:f}),p.push(a)}if(i){var v=this;return function(){return v.wildcardNotify(d,p)}}this.wildcardNotify(d,p)},t.prototype.runUpdateQueue=function(){if(!this.destroyed)for(;this.updateQueue.length&&this.updateQueue.length<this.options.maxSimultaneousJobs;){var t=this.updateQueue.shift();t.options.queue=!1,this.update(t.updatePath,t.fnOrValue,t.options,t.multi)}},t.prototype.updateNotify=function(t,e,n){var r=this.notifySubscribedListeners(t,e,n);this.canBeNested(e)&&this.notifyNestedListeners(t,e,n,"update",r),this.executeWaitingListeners(t)},t.prototype.updateNotifyOnly=function(t,e,n){this.notifyOnly(t,e,n),this.executeWaitingListeners(t)},t.prototype.update=function(t,e,r,i){var s=this;if(void 0===r&&(r=n({},h)),void 0===i&&(i=!1),!this.destroyed){var o=this.jobsRunning;if((this.options.queue||r.queue)&&o){if(o>this.options.maxSimultaneousJobs)throw new Error("Maximal simultaneous jobs limit reached.");this.updateQueue.push({updatePath:t,fnOrValue:e,options:r,multi:i});var a=Promise.resolve().then((function(){s.runUpdateQueue()}));return i?function(){return a}:a}if(this.isWildcard(t))return this.wildcardUpdate(t,e,r,i);++this.jobsRunning;var u=this.split(t),l=this.getUpdateValues(this.pathGet(u,this.data),u,e),c=l.oldValue,f=l.newValue;if(r.debug&&this.options.log("Updating "+t+" "+(r.source?"from "+r.source:""),{oldValue:c,newValue:f}),this.same(f,c)&&!r.force)return--this.jobsRunning,i?function(){return f}:f;if(this.pathSet(u,f,this.data),null===(r=n({},h,r)).only)return--this.jobsRunning,i?function(){}:f;if(r.only.length){if(--this.jobsRunning,i){var d=this;return function(){return d.updateNotifyOnly(t,f,r)}}return this.updateNotifyOnly(t,f,r),f}if(i){--this.jobsRunning;var p=this;return function(){return p.updateNotify(t,f,r)}}return this.updateNotify(t,f,r),--this.jobsRunning,f}},t.prototype.multi=function(){if(this.destroyed)return{update:function(){},done:function(){}};var t=this,e=[];return{update:function(n,r,i){return void 0===i&&(i=h),e.push(t.update(n,r,i,!0)),this},done:function(){for(var t=0,n=e.length;t<n;t++)e[t]();e.length=0}}},t.prototype.get=function(t){if(void 0===t&&(t=void 0),!this.destroyed)return void 0===t||""===t?this.data:this.pathGet(this.split(t),this.data)},t.prototype.last=function(t){var e=this,n=this.lastExecs.get(t);n||(n={calls:0},this.lastExecs.set(t,n));var r=++n.calls;this.resolved.then((function(){r===n.calls&&(e.lastExecs.set(t,{calls:0}),t())}))},t.prototype.isMuted=function(t){var e,n;if(!this.options.useMute)return!1;try{for(var r=s(this.muted),i=r.next();!i.done;i=r.next()){var o=i.value;if(this.match(t,o))return!0;if(this.match(o,t))return!0}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return!1},t.prototype.mute=function(t){this.muted.add(t)},t.prototype.unmute=function(t){this.muted.delete(t)},t.prototype.debugSubscribe=function(t,e,n){t.options.debug&&this.options.log("listener subscribed",{listenerPath:n,listener:t,listenersCollection:e})},t.prototype.debugListener=function(t,e){(e.eventInfo.options.debug||e.listener.options.debug)&&this.options.log("Listener fired",{time:Date.now()-t,info:e})},t.prototype.debugTime=function(t){return t.listener.options.debug||t.eventInfo.options.debug?Date.now():0},t}();e.default=c}));
/**
     * @license
     * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
     * This code may only be used under the BSD style license found at
     * http://polymer.github.io/LICENSE.txt
     * The complete set of authors may be found at
     * http://polymer.github.io/AUTHORS.txt
     * The complete set of contributors may be found at
     * http://polymer.github.io/CONTRIBUTORS.txt
     * Code distributed by Google as part of the polymer project is also
     * subject to an additional IP rights grant found at
     * http://polymer.github.io/PATENTS.txt
     */
String(Math.random()).slice(2),document.createComment(""),window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:t=>t}),document.createElement("template"),document.createTextNode("");let j=!1;(()=>{try{const t={get capture(){return j=!0,!1}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){}})(),
/**
     * @license
     * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
     * This code may only be used under the BSD style license found at
     * http://polymer.github.io/LICENSE.txt
     * The complete set of authors may be found at
     * http://polymer.github.io/AUTHORS.txt
     * The complete set of contributors may be found at
     * http://polymer.github.io/CONTRIBUTORS.txt
     * Code distributed by Google as part of the polymer project is also
     * subject to an additional IP rights grant found at
     * http://polymer.github.io/PATENTS.txt
     */
"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.3.0")
/**
     * @license
     * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
     * This code may only be used under the BSD style license found at
     * http://polymer.github.io/LICENSE.txt
     * The complete set of authors may be found at
     * http://polymer.github.io/AUTHORS.txt
     * The complete set of contributors may be found at
     * http://polymer.github.io/CONTRIBUTORS.txt
     * Code distributed by Google as part of the polymer project is also
     * subject to an additional IP rights grant found at
     * http://polymer.github.io/PATENTS.txt
     */;
/**
     * @license
     * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
     * This code may only be used under the BSD style license found at
     * http://polymer.github.io/LICENSE.txt
     * The complete set of authors may be found at
     * http://polymer.github.io/AUTHORS.txt
     * The complete set of contributors may be found at
     * http://polymer.github.io/CONTRIBUTORS.txt
     * Code distributed by Google as part of the polymer project is also
     * subject to an additional IP rights grant found at
     * http://polymer.github.io/PATENTS.txt
     */
document.createElement("template"),document.createTextNode("");const k="gstc";function A(t,e=""){let n="gstc__"+t;return t===k&&(n=k),e?`${n} ${n}--${e.replace(":","-")}`:n}const W="config.plugin.TimeBookmarks",H="config.slots.chart.content";class V{constructor(t,e){this.unsub=[],this.options=function(t){return Object.assign({enabled:!0,className:A("chart-time-bookmark")},t)}(t),this.vido=e,this.state=e.state,this.className=this.options.className,this.slotComponent=this.slotComponent.bind(this),this.state.update(W,this.options),this.state.update(H,t=>(t.includes(this.slotComponent)||t.push(this.slotComponent),t)),this.unsub.push(this.state.subscribe(W,t=>this.options=t))}destroy(){this.unsub.forEach(t=>t()),this.state.update(H,t=>t.filter(t=>t!==this.slotComponent))}slotComponent(t){const{html:e,onDestroy:n,state:r,update:i,api:s}=t,o="#3498DB",a=[];n(r.subscribeAll([W,"config.chart.time","config.scroll.horizontal.dataIndex"],()=>{const t=r.get(W);a.length=0;for(const e in t.bookmarks){const n=Object.assign(Object.assign({},t.bookmarks[e]),{id:e,leftViewPx:0});n.id=e,n.leftViewPx=s.time.getViewOffsetPxFromDates(s.time.date(n.time)),a.push(n)}i()}));let u=0;n(r.subscribe("config.headerHeight",t=>{u=t,i()}));let l=0;n(r.subscribe("config.innerHeight",t=>{l=t,i()}));let h=0;n(r.subscribe("config.scroll.horizontal.size",t=>{h=t,i()}));const c=t=>e`<div
        class="${this.className} ${this.className}--${t.id}"
        style="left:${t.leftViewPx}px;top: ${u-8}px;"
      >
        <div class="${this.className}-handle" style="background: ${t.color||o};">
          ${t.label}
        </div>
        <div class="${this.className}-line" style="border-left: 1px solid ${t.color||o};"></div>
      </div>`;return t=>e`${t}
        <div class="${this.className}s" style="height: ${l+u-h}px;">
          ${a.map(t=>c(t))}
        </div>`}}t.Plugin=function(t={}){return function(e){const n=e.state.get(W);n&&(t=e.api.mergeDeep({},t,n));return new V(t,e).destroy}},t.pluginPath=W,t.slotPath=H,Object.defineProperty(t,"__esModule",{value:!0})}));
