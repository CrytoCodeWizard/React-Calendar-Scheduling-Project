var t=function(){if("undefined"!=typeof Map)return Map;function t(t,e){var i=-1;return t.some((function(t,n){return t[0]===e&&(i=n,!0)})),i}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var i=t(this.__entries__,e),n=this.__entries__[i];return n&&n[1]},e.prototype.set=function(e,i){var n=t(this.__entries__,e);~n?this.__entries__[n][1]=i:this.__entries__.push([e,i])},e.prototype.delete=function(e){var i=this.__entries__,n=t(i,e);~n&&i.splice(n,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var i=0,n=this.__entries__;i<n.length;i++){var r=n[i];t.call(e,r[1],r[0])}},e}()}(),e="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,i="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),n="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(i):function(t){return setTimeout((function(){return t(Date.now())}),1e3/60)};var r=["top","right","bottom","left","width","height","size","weight"],s="undefined"!=typeof MutationObserver,o=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var i=!1,r=!1,s=0;function o(){i&&(i=!1,t()),r&&u()}function a(){n(o)}function u(){var t=Date.now();if(i){if(t-s<2)return;r=!0}else i=!0,r=!1,setTimeout(a,e);s=t}return u}(this.refresh.bind(this),20)}return t.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},t.prototype.removeObserver=function(t){var e=this.observers_,i=e.indexOf(t);~i&&e.splice(i,1),!e.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},t.prototype.updateObservers_=function(){var t=this.observers_.filter((function(t){return t.gatherActive(),t.hasActive()}));return t.forEach((function(t){return t.broadcastActive()})),t.length>0},t.prototype.connect_=function(){e&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),s?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){e&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(t){var e=t.propertyName,i=void 0===e?"":e;r.some((function(t){return!!~i.indexOf(t)}))&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),a=function(t,e){for(var i=0,n=Object.keys(e);i<n.length;i++){var r=n[i];Object.defineProperty(t,r,{value:e[r],enumerable:!1,writable:!1,configurable:!0})}return t},u=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||i},h=v(0,0,0,0);function l(t){return parseFloat(t)||0}function d(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return e.reduce((function(e,i){return e+l(t["border-"+i+"-width"])}),0)}function c(t){var e=t.clientWidth,i=t.clientHeight;if(!e&&!i)return h;var n=u(t).getComputedStyle(t),r=function(t){for(var e={},i=0,n=["top","right","bottom","left"];i<n.length;i++){var r=n[i],s=t["padding-"+r];e[r]=l(s)}return e}(n),s=r.left+r.right,o=r.top+r.bottom,a=l(n.width),c=l(n.height);if("border-box"===n.boxSizing&&(Math.round(a+s)!==e&&(a-=d(n,"left","right")+s),Math.round(c+o)!==i&&(c-=d(n,"top","bottom")+o)),!function(t){return t===u(t).document.documentElement}(t)){var f=Math.round(a+s)-e,p=Math.round(c+o)-i;1!==Math.abs(f)&&(a-=f),1!==Math.abs(p)&&(c-=p)}return v(r.left,r.top,a,c)}var f="undefined"!=typeof SVGGraphicsElement?function(t){return t instanceof u(t).SVGGraphicsElement}:function(t){return t instanceof u(t).SVGElement&&"function"==typeof t.getBBox};function p(t){return e?f(t)?function(t){var e=t.getBBox();return v(0,0,e.width,e.height)}(t):c(t):h}function v(t,e,i,n){return{x:t,y:e,width:i,height:n}}var m=function(){function t(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=v(0,0,0,0),this.target=t}return t.prototype.isActive=function(){var t=p(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},t}(),g=function(t,e){var i,n,r,s,o,u,h,l=(n=(i=e).x,r=i.y,s=i.width,o=i.height,u="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,h=Object.create(u.prototype),a(h,{x:n,y:r,width:s,height:o,top:r,right:n+s,bottom:o+r,left:n}),h);a(this,{target:t,contentRect:l})},y=function(){function e(e,i,n){if(this.activeObservations_=[],this.observations_=new t,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=i,this.callbackCtx_=n}return e.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof u(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new m(t)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof u(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach((function(e){e.isActive()&&t.activeObservations_.push(e)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map((function(t){return new g(t.target,t.broadcastRect())}));this.callback_.call(t,e,t),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),b="undefined"!=typeof WeakMap?new WeakMap:new t,w=function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var i=o.getInstance(),n=new y(e,i,this);b.set(this,n)};["observe","unobserve","disconnect"].forEach((function(t){w.prototype[t]=function(){var e;return(e=b.get(this))[t].apply(e,arguments)}}));void 0!==i.ResizeObserver&&i.ResizeObserver;var _="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function D(t,e,i){return t(i={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&i.path)}},i.exports),i.exports}function M(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})})),e}D((function(t,e){t.exports=function(){var t="millisecond",e="second",i="minute",n="hour",r="day",s="week",o="month",a="quarter",u="year",h="date",l=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d+)?$/,d=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,c=function(t,e,i){var n=String(t);return!n||n.length>=e?t:""+Array(e+1-n.length).join(i)+t},f={s:c,z:function(t){var e=-t.utcOffset(),i=Math.abs(e),n=Math.floor(i/60),r=i%60;return(e<=0?"+":"-")+c(n,2,"0")+":"+c(r,2,"0")},m:function t(e,i){if(e.date()<i.date())return-t(i,e);var n=12*(i.year()-e.year())+(i.month()-e.month()),r=e.clone().add(n,o),s=i-r<0,a=e.clone().add(n+(s?-1:1),o);return+(-(n+(i-r)/(s?r-a:a-r))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(l){return{M:o,y:u,w:s,d:r,D:h,h:n,m:i,s:e,ms:t,Q:a}[l]||String(l||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},p={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},v="en",m={};m[v]=p;var g=function(t){return t instanceof _},y=function(t,e,i){var n;if(!t)return v;if("string"==typeof t)m[t]&&(n=t),e&&(m[t]=e,n=t);else{var r=t.name;m[r]=t,n=r}return!i&&n&&(v=n),n||!i&&v},b=function(t,e){if(g(t))return t.clone();var i="object"==typeof e?e:{};return i.date=t,i.args=arguments,new _(i)},w=f;w.l=y,w.i=g,w.w=function(t,e){return b(t,{locale:e.$L,utc:e.$u,$offset:e.$offset})};var _=function(){function c(t){this.$L=this.$L||y(t.locale,null,!0),this.parse(t)}var f=c.prototype;return f.parse=function(t){this.$d=function(t){var e=t.date,i=t.utc;if(null===e)return new Date(NaN);if(w.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var n=e.match(l);if(n){var r=n[2]-1||0,s=(n[7]||"0").substring(0,3);return i?new Date(Date.UTC(n[1],r,n[3]||1,n[4]||0,n[5]||0,n[6]||0,s)):new Date(n[1],r,n[3]||1,n[4]||0,n[5]||0,n[6]||0,s)}}return new Date(e)}(t),this.init()},f.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},f.$utils=function(){return w},f.isValid=function(){return!("Invalid Date"===this.$d.toString())},f.isSame=function(t,e){var i=b(t);return this.startOf(e)<=i&&i<=this.endOf(e)},f.isAfter=function(t,e){return b(t)<this.startOf(e)},f.isBefore=function(t,e){return this.endOf(e)<b(t)},f.$g=function(t,e,i){return w.u(t)?this[e]:this.set(i,t)},f.unix=function(){return Math.floor(this.valueOf()/1e3)},f.valueOf=function(){return this.$d.getTime()},f.startOf=function(t,a){var l=this,d=!!w.u(a)||a,c=w.p(t),f=function(t,e){var i=w.w(l.$u?Date.UTC(l.$y,e,t):new Date(l.$y,e,t),l);return d?i:i.endOf(r)},p=function(t,e){return w.w(l.toDate()[t].apply(l.toDate("s"),(d?[0,0,0,0]:[23,59,59,999]).slice(e)),l)},v=this.$W,m=this.$M,g=this.$D,y="set"+(this.$u?"UTC":"");switch(c){case u:return d?f(1,0):f(31,11);case o:return d?f(1,m):f(0,m+1);case s:var b=this.$locale().weekStart||0,_=(v<b?v+7:v)-b;return f(d?g-_:g+(6-_),m);case r:case h:return p(y+"Hours",0);case n:return p(y+"Minutes",1);case i:return p(y+"Seconds",2);case e:return p(y+"Milliseconds",3);default:return this.clone()}},f.endOf=function(t){return this.startOf(t,!1)},f.$set=function(s,a){var l,d=w.p(s),c="set"+(this.$u?"UTC":""),f=(l={},l[r]=c+"Date",l[h]=c+"Date",l[o]=c+"Month",l[u]=c+"FullYear",l[n]=c+"Hours",l[i]=c+"Minutes",l[e]=c+"Seconds",l[t]=c+"Milliseconds",l)[d],p=d===r?this.$D+(a-this.$W):a;if(d===o||d===u){var v=this.clone().set(h,1);v.$d[f](p),v.init(),this.$d=v.set(h,Math.min(this.$D,v.daysInMonth())).$d}else f&&this.$d[f](p);return this.init(),this},f.set=function(t,e){return this.clone().$set(t,e)},f.get=function(t){return this[w.p(t)]()},f.add=function(t,a){var h,l=this;t=Number(t);var d=w.p(a),c=function(e){var i=b(l);return w.w(i.date(i.date()+Math.round(e*t)),l)};if(d===o)return this.set(o,this.$M+t);if(d===u)return this.set(u,this.$y+t);if(d===r)return c(1);if(d===s)return c(7);var f=(h={},h[i]=6e4,h[n]=36e5,h[e]=1e3,h)[d]||1,p=this.$d.getTime()+t*f;return w.w(p,this)},f.subtract=function(t,e){return this.add(-1*t,e)},f.format=function(t){var e=this;if(!this.isValid())return"Invalid Date";var i=t||"YYYY-MM-DDTHH:mm:ssZ",n=w.z(this),r=this.$locale(),s=this.$H,o=this.$m,a=this.$M,u=r.weekdays,h=r.months,l=function(t,n,r,s){return t&&(t[n]||t(e,i))||r[n].substr(0,s)},c=function(t){return w.s(s%12||12,t,"0")},f=r.meridiem||function(t,e,i){var n=t<12?"AM":"PM";return i?n.toLowerCase():n},p={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:w.s(a+1,2,"0"),MMM:l(r.monthsShort,a,h,3),MMMM:l(h,a),D:this.$D,DD:w.s(this.$D,2,"0"),d:String(this.$W),dd:l(r.weekdaysMin,this.$W,u,2),ddd:l(r.weekdaysShort,this.$W,u,3),dddd:u[this.$W],H:String(s),HH:w.s(s,2,"0"),h:c(1),hh:c(2),a:f(s,o,!0),A:f(s,o,!1),m:String(o),mm:w.s(o,2,"0"),s:String(this.$s),ss:w.s(this.$s,2,"0"),SSS:w.s(this.$ms,3,"0"),Z:n};return i.replace(d,(function(t,e){return e||p[t]||n.replace(":","")}))},f.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},f.diff=function(t,h,l){var d,c=w.p(h),f=b(t),p=6e4*(f.utcOffset()-this.utcOffset()),v=this-f,m=w.m(this,f);return m=(d={},d[u]=m/12,d[o]=m,d[a]=m/3,d[s]=(v-p)/6048e5,d[r]=(v-p)/864e5,d[n]=v/36e5,d[i]=v/6e4,d[e]=v/1e3,d)[c]||v,l?m:w.a(m)},f.daysInMonth=function(){return this.endOf(o).$D},f.$locale=function(){return m[this.$L]},f.locale=function(t,e){if(!t)return this.$L;var i=this.clone(),n=y(t,e,!0);return n&&(i.$L=n),i},f.clone=function(){return w.w(this.$d,this)},f.toDate=function(){return new Date(this.valueOf())},f.toJSON=function(){return this.isValid()?this.toISOString():null},f.toISOString=function(){return this.$d.toISOString()},f.toString=function(){return this.$d.toUTCString()},c}(),D=_.prototype;return b.prototype=D,[["$ms",t],["$s",e],["$m",i],["$H",n],["$W",r],["$M",o],["$y",u],["$D",h]].forEach((function(t){D[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),b.extend=function(t,e){return t(e,_,b),b},b.locale=y,b.isDayjs=g,b.unix=function(t){return b(1e3*t)},b.en=m[v],b.Ls=m,b}()})),D((function(t,e){t.exports=function(t,e,i){var n=(new Date).getTimezoneOffset(),r=e.prototype;i.utc=function(t){return new e({date:t,utc:!0,args:arguments})},r.utc=function(){return i(this.toDate(),{locale:this.$L,utc:!0})},r.local=function(){return i(this.toDate(),{locale:this.$L,utc:!1})};var s=r.parse;r.parse=function(t){t.utc&&(this.$u=!0),this.$utils().u(t.$offset)||(this.$offset=t.$offset),s.call(this,t)};var o=r.init;r.init=function(){if(this.$u){var t=this.$d;this.$y=t.getUTCFullYear(),this.$M=t.getUTCMonth(),this.$D=t.getUTCDate(),this.$W=t.getUTCDay(),this.$H=t.getUTCHours(),this.$m=t.getUTCMinutes(),this.$s=t.getUTCSeconds(),this.$ms=t.getUTCMilliseconds()}else o.call(this)};var a=r.utcOffset;r.utcOffset=function(t,e){var i=this.$utils().u;if(i(t))return this.$u?0:i(this.$offset)?a.call(this):this.$offset;var r=Math.abs(t)<=16?60*t:t,s=this;return e?(s.$offset=r,s.$u=0===t,s):(0!==t?(s=this.local().add(r+n,"minute")).$offset=r:s=this.utc(),s)};var u=r.format;r.format=function(t){var e=t||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return u.call(this,e)},r.valueOf=function(){var t=this.$utils().u(this.$offset)?0:this.$offset+n;return this.$d.valueOf()-6e4*t},r.isUTC=function(){return!!this.$u},r.toISOString=function(){return this.toDate().toISOString()},r.toString=function(){return this.toDate().toUTCString()};var h=r.toDate;r.toDate=function(t){return"s"===t&&this.$offset?i(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():h.call(this)};var l=r.diff;r.diff=function(t,e,n){var r=this.local(),s=i(t).local();return l.call(r,s,e,n)}}}));var x=D((function(t,e){function i(t,e){void 0===e&&(e="*"),this.wchar=e,this.pattern=t,this.segments=[],this.starCount=0,this.minLength=0,this.maxLength=0,this.segStartIndex=0;for(var i=0,n=t.length;i<n;i+=1){var r=t[i];r===e&&(this.starCount+=1,i>this.segStartIndex&&this.segments.push(t.substring(this.segStartIndex,i)),this.segments.push(r),this.segStartIndex=i+1)}this.segStartIndex<t.length&&this.segments.push(t.substring(this.segStartIndex)),this.starCount?(this.minLength=t.length-this.starCount,this.maxLength=1/0):this.maxLength=this.minLength=t.length}e.__esModule=!0,i.prototype.match=function(t){if(this.pattern===this.wchar)return!0;if(0===this.segments.length)return this.pattern===t;var e=t.length;if(e<this.minLength||e>this.maxLength)return!1;for(var i=this.segments.length-1,n=t.length-1,r=!1;;){var s=this.segments[i];if(i-=1,s===this.wchar)r=!0;else{var o=n+1-s.length,a=t.lastIndexOf(s,o);if(-1===a||a>o)return!1;if(r)n=a-1,r=!1;else{if(a!==o)return!1;n-=s.length}}if(0>i)break}return!0},e.default=i})),$=D((function(t,e){var i=_&&_.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],i=0;return e?e.call(t):{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}}};function n(t,e,i,n){void 0===n&&(n=void 0),this.obj=t,this.delimeter=e,this.wildcard=i,this.is_match=n}e.__esModule=!0,n.prototype.simpleMatch=function(t,e){if(t===e)return!0;if(t===this.wildcard)return!0;if(this.is_match)return this.is_match(t,e);var i=t.indexOf(this.wildcard);if(i>-1){var n=t.substr(i+1);if(0===i||e.substring(0,i)===t.substring(0,i)){var r=n.length;return!(r>0)||e.substr(-r)===n}}return!1},n.prototype.match=function(t,e){return this.is_match?this.is_match(t,e):t===e||t===this.wildcard||e===this.wildcard||this.simpleMatch(t,e)||new x.default(t).match(e)},n.prototype.handleArray=function(t,e,n,r,s){var o,a;void 0===s&&(s={});var u=t.indexOf(this.delimeter,n),h=!1;-1===u&&(h=!0,u=t.length);var l=t.substring(n,u),d=0;try{for(var c=i(e),f=c.next();!f.done;f=c.next()){var p=f.value,v=d.toString(),m=""===r?v:r+this.delimeter+d;(l===this.wildcard||l===v||this.simpleMatch(l,v))&&(h?s[m]=p:this.goFurther(t,p,u+1,m,s)),d++}}catch(t){o={error:t}}finally{try{f&&!f.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}return s},n.prototype.handleObject=function(t,e,i,n,r){void 0===r&&(r={});var s=t.indexOf(this.delimeter,i),o=!1;-1===s&&(o=!0,s=t.length);var a=t.substring(i,s);for(var u in e){u=u.toString();var h=""===n?u:n+this.delimeter+u;(a===this.wildcard||a===u||this.simpleMatch(a,u))&&(o?r[h]=e[u]:this.goFurther(t,e[u],s+1,h,r))}return r},n.prototype.goFurther=function(t,e,i,n,r){return void 0===r&&(r={}),Array.isArray(e)?this.handleArray(t,e,i,n,r):this.handleObject(t,e,i,n,r)},n.prototype.get=function(t){return this.goFurther(t,this.obj,0,"")},e.default=n})),O=D((function(t,e){var i=_&&_.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],i=0;return e?e.call(t):{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}}};e.__esModule=!0;var n=function(){function t(){}return t.get=function(t,e,n){var r,s;if(void 0===n&&(n=!1),e){var o=e;try{for(var a=i(t),u=a.next();!u.done;u=a.next()){var h=u.value;if(o.hasOwnProperty(h))o=o[h];else{if(!n)return;o[h]={},o=o[h]}}}catch(t){r={error:t}}finally{try{u&&!u.done&&(s=a.return)&&s.call(a)}finally{if(r)throw r.error}}return o}},t.set=function(e,i,n){if(n){if(0!==e.length){var r=e.slice(),s=r.pop(),o=t.get(r,n,!0);return"object"==typeof o&&(o[s]=i),i}for(var a in i)n[a]=i[a]}},t}();e.default=n}));let S,I=0,P=null;function L(){return null!==P&&P.buffer===S.memory.buffer||(P=new Uint8Array(S.memory.buffer)),P}let R=new TextEncoder("utf-8");const C="function"==typeof R.encodeInto?function(t,e){return R.encodeInto(t,e)}:function(t,e){const i=R.encode(t);return e.set(i),{read:t.length,written:i.length}};function E(t,e,i){if(void 0===i){const i=R.encode(t),n=e(i.length);return L().subarray(n,n+i.length).set(i),I=i.length,n}let n=t.length,r=e(n);const s=L();let o=0;for(;o<n;o++){const e=t.charCodeAt(o);if(e>127)break;s[r+o]=e}if(o!==n){0!==o&&(t=t.slice(o)),r=i(r,n,n=o+3*t.length);const e=L().subarray(r+o,r+n);o+=C(t,e).written}return I=o,r}var T=M(Object.freeze({__proto__:null,is_match:function(t,e){var i=E(t,S.__wbindgen_malloc,S.__wbindgen_realloc),n=I,r=E(e,S.__wbindgen_malloc,S.__wbindgen_realloc),s=I;return 0!==S.is_match(i,n,r,s)},default:async function t(e){("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:i,module:n}=await async function(t,e){if("function"==typeof Response&&t instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(t,e)}catch(e){if("application/wasm"==t.headers.get("Content-Type"))throw e;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",e)}const i=await t.arrayBuffer();return await WebAssembly.instantiate(i,e)}{const i=await WebAssembly.instantiate(t,e);return i instanceof WebAssembly.Instance?{instance:i,module:t}:i}}(await e,{});return S=i.exports,t.__wbindgen_wasm_module=n,S}}));D((function(t,e){var i=_&&_.__assign||function(){return(i=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},n=_&&_.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{u(n.next(t))}catch(t){s(t)}}function a(t){try{u(n.throw(t))}catch(t){s(t)}}function u(t){t.done?r(t.value):new i((function(e){e(t.value)})).then(o,a)}u((n=n.apply(t,e||[])).next())}))},r=_&&_.__generator||function(t,e){var i,n,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(r=2&s[0]?n.return:s[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,s[1])).done)return r;switch(n=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],n=0}finally{i=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},s=_&&_.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],i=0;return e?e.call(t):{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}}},o=_&&_.__read||function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,r,s=i.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(t){r={error:t}}finally{try{n&&!n.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return o},a=_&&_.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t};function u(t,e){console.debug(t,e)}e.__esModule=!0;var h={bulk:!1,debug:!1,source:"",data:void 0,queue:!1},l={only:[],source:"",debug:!1,data:void 0,queue:!1,force:!1},d=function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e={}),this.jobsRunning=0,this.updateQueue=[],this.subscribeQueue=[],this.listenersIgnoreCache=new WeakMap,this.destroyed=!1,this.queueRuns=0,this.lastExecs=new WeakMap,this.listeners=new Map,this.waitingListeners=new Map,this.data=t,this.options=i({},{delimiter:".",useMute:!0,notRecursive:";",param:":",wildcard:"*",experimentalMatch:!1,queue:!1,maxSimultaneousJobs:1e3,maxQueueRuns:1e3,log:u,Promise:Promise},e),this.id=0,this.pathGet=O.default.get,this.pathSet=O.default.set,e.Promise?this.resolved=e.Promise.resolve():this.resolved=Promise.resolve(),this.muted=new Set,this.scan=new $.default(this.data,this.options.delimiter,this.options.wildcard),this.destroyed=!1}return t.prototype.loadWasmMatcher=function(t){return n(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,T.default(t)];case 1:return e.sent(),this.is_match=T.is_match,this.scan=new $.default(this.data,this.options.delimiter,this.options.wildcard,this.is_match),[2]}}))}))},t.prototype.same=function(t,e){return(["number","string","undefined","boolean"].includes(typeof t)||null===t)&&e===t},t.prototype.getListeners=function(){return this.listeners},t.prototype.destroy=function(){this.destroyed=!0,this.data=void 0,this.listeners=new Map,this.updateQueue=[],this.jobsRunning=0},t.prototype.match=function(t,e){return this.is_match?this.is_match(t,e):t===e||(t===this.options.wildcard||e===this.options.wildcard||this.scan.match(t,e))},t.prototype.getIndicesOf=function(t,e){var i=t.length;if(0==i)return[];for(var n,r=0,s=[];(n=e.indexOf(t,r))>-1;)s.push(n),r=n+i;return s},t.prototype.getIndicesCount=function(t,e){var i=t.length;if(0==i)return 0;for(var n,r=0,s=0;(n=e.indexOf(t,r))>-1;)s++,r=n+i;return s},t.prototype.cutPath=function(t,e){t=this.cleanNotRecursivePath(t),e=this.cleanNotRecursivePath(e);var i=this.getIndicesCount(this.options.delimiter,e),n=this.getIndicesOf(this.options.delimiter,t);return t.substr(0,n[i])},t.prototype.trimPath=function(t){return(t=this.cleanNotRecursivePath(t)).charAt(0)===this.options.delimiter?t.substr(1):t},t.prototype.split=function(t){return""===t?[]:t.split(this.options.delimiter)},t.prototype.isWildcard=function(t){return t.includes(this.options.wildcard)||this.hasParams(t)},t.prototype.isNotRecursive=function(t){return t.endsWith(this.options.notRecursive)},t.prototype.cleanNotRecursivePath=function(t){return this.isNotRecursive(t)?t.substring(0,t.length-1):t},t.prototype.hasParams=function(t){return t.includes(this.options.param)},t.prototype.getParamsInfo=function(t){var e,i,n={replaced:"",original:t,params:{}},r=0,o=[];try{for(var a=s(this.split(t)),u=a.next();!u.done;u=a.next()){var h=u.value;n.params[r]={original:h,replaced:"",name:""};var l=new RegExp("\\"+this.options.param+"([^\\"+this.options.delimiter+"\\"+this.options.param+"]+)","g"),d=l.exec(h);d?(n.params[r].name=d[1],l.lastIndex=0,n.params[r].replaced=h.replace(l,this.options.wildcard),o.push(n.params[r].replaced),r++):(delete n.params[r],o.push(h),r++)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}return n.replaced=o.join(this.options.delimiter),n},t.prototype.getParams=function(t,e){if(t){var i=this.split(e),n={};for(var r in t.params){n[t.params[r].name]=i[r]}return n}},t.prototype.waitForAll=function(t,e){var i,n,r={};try{for(var o=s(t),a=o.next();!a.done;a=o.next()){var u=a.value;r[u]={dirty:!1},this.hasParams(u)&&(r[u].paramsInfo=this.getParamsInfo(u)),r[u].isWildcard=this.isWildcard(u),r[u].isRecursive=!this.isNotRecursive(u)}}catch(t){i={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return this.waitingListeners.set(t,{fn:e,paths:r}),e(r),function(){this.waitingListeners.delete(t)}},t.prototype.executeWaitingListeners=function(t){var e,i;if(!this.destroyed)try{for(var n=s(this.waitingListeners.values()),r=n.next();!r.done;r=n.next()){var o=r.value,a=o.fn,u=o.paths,h=0,l=0;for(var d in u){var c=u[d],f=!1;c.isRecursive&&(t=this.cutPath(t,d)),c.isWildcard&&this.match(d,t)&&(f=!0),t===d&&(f=!0),f&&(c.dirty=!0),c.dirty&&h++,l++}h===l&&a(u)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}},t.prototype.subscribeAll=function(t,e,i){var n,r;if(void 0===i&&(i=h),this.destroyed)return function(){};var o=[];try{for(var a=s(t),u=a.next();!u.done;u=a.next()){var l=u.value;o.push(this.subscribe(l,e,i))}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return function(){var t,e;try{for(var i=s(o),n=i.next();!n.done;n=i.next()){(0,n.value)()}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}}},t.prototype.getCleanListenersCollection=function(t){return void 0===t&&(t={}),i({listeners:new Map,isRecursive:!1,isWildcard:!1,hasParams:!1,match:void 0,paramsInfo:void 0,path:void 0,originalPath:void 0,count:0},t)},t.prototype.getCleanListener=function(t,e){return void 0===e&&(e=h),{fn:t,options:i({},h,e)}},t.prototype.getListenerCollectionMatch=function(t,e,i){t=this.cleanNotRecursivePath(t);var n=this;return function(r){return e&&(r=n.cutPath(r,t)),!(!i||!n.match(t,r))||t===r}},t.prototype.getListenersCollection=function(t,e){if(this.listeners.has(t)){var n=this.listeners.get(t);return n.listeners.set(++this.id,e),n}var r,s=this.hasParams(t);s&&(r=this.getParamsInfo(t));var o={isRecursive:!this.isNotRecursive(t),isWildcard:this.isWildcard(t),hasParams:s,paramsInfo:r,originalPath:t,path:s?r.replaced:t},a=this.getCleanListenersCollection(i({},o,{match:this.getListenerCollectionMatch(o.path,o.isRecursive,o.isWildcard)}));return this.id++,a.listeners.set(this.id,e),this.listeners.set(o.originalPath,a),a},t.prototype.subscribe=function(t,e,i,n){if(void 0===i&&(i=h),void 0===n&&(n="subscribe"),this.destroyed)return function(){};this.jobsRunning++;var r=this.getCleanListener(e,i);this.listenersIgnoreCache.set(r,{truthy:[],falsy:[]});var s=this.getListenersCollection(t,r);s.count++;var o=this.cleanNotRecursivePath(s.path);if(s.isWildcard){var a=this.scan.get(o);if(i.bulk){var u=[];for(var l in a)this.isMuted(l)||u.push({path:l,params:this.getParams(s.paramsInfo,l),value:a[l]});e(u,{type:n,listener:r,listenersCollection:s,path:{listener:t,update:void 0,resolved:void 0},options:i,params:void 0})}else for(var l in a)this.isMuted(l)||e(a[l],{type:n,listener:r,listenersCollection:s,path:{listener:t,update:void 0,resolved:this.cleanNotRecursivePath(l)},params:this.getParams(s.paramsInfo,l),options:i})}else this.isMuted(o)||e(this.pathGet(this.split(o),this.data),{type:n,listener:r,listenersCollection:s,path:{listener:t,update:void 0,resolved:this.cleanNotRecursivePath(t)},params:this.getParams(s.paramsInfo,o),options:i});return this.debugSubscribe(r,s,t),this.jobsRunning--,this.unsubscribe(t,this.id)},t.prototype.unsubscribe=function(t,e){var i=this.listeners,n=i.get(t);return function(){n.listeners.delete(e),n.count--,0===n.count&&i.delete(t)}},t.prototype.runQueuedListeners=function(){var t=this;if(!this.destroyed&&0!==this.subscribeQueue.length)if(0===this.jobsRunning){this.queueRuns=0;for(var e=a(this.subscribeQueue),i=0,n=e.length;i<n;i++)e[i]();this.subscribeQueue.length=0}else{if(this.queueRuns++,this.queueRuns>=this.options.maxQueueRuns)throw this.queueRuns=0,new Error("Maximal number of queue runs exhausted.");Promise.resolve().then((function(){return t.runQueuedListeners()})).catch((function(t){throw t}))}},t.prototype.notifyListeners=function(t,e,n){var r,o,a,u,h=this;void 0===e&&(e=[]),void 0===n&&(n=!0);var l=[];for(var d in t)if(!this.isMuted(d)){var c=t[d],f=c.single,p=c.bulk,v=function(t){if(e.includes(t))return"continue";var i=m.debugTime(t);t.listener.options.queue&&m.jobsRunning?m.subscribeQueue.push((function(){t.listener.fn(t.value(),t.eventInfo)})):t.listener.fn(t.value(),t.eventInfo),n&&l.push(t),m.debugListener(i,t)},m=this;try{for(var g=(r=void 0,s(f)),y=g.next();!y.done;y=g.next()){v(y.value)}}catch(t){r={error:t}}finally{try{y&&!y.done&&(o=g.return)&&o.call(g)}finally{if(r)throw r.error}}var b=function(t){var r,o;if(e.includes(t))return"continue";var a=w.debugTime(t),u=[];try{for(var d=(r=void 0,s(t.value)),c=d.next();!c.done;c=d.next()){var f=c.value;u.push(i({},f,{value:f.value()}))}}catch(t){r={error:t}}finally{try{c&&!c.done&&(o=d.return)&&o.call(d)}finally{if(r)throw r.error}}t.listener.options.queue&&w.jobsRunning?w.subscribeQueue.push((function(){return!h.jobsRunning&&(t.listener.fn(u,t.eventInfo),!0)})):t.listener.fn(u,t.eventInfo),n&&l.push(t),w.debugListener(a,t)},w=this;try{for(var _=(a=void 0,s(p)),D=_.next();!D.done;D=_.next()){b(D.value)}}catch(t){a={error:t}}finally{try{D&&!D.done&&(u=_.return)&&u.call(_)}finally{if(a)throw a.error}}}return Promise.resolve().then((function(){return h.runQueuedListeners()})),l},t.prototype.shouldIgnore=function(t,e){var i,n;if(!t.options.ignore)return!1;try{for(var r=s(t.options.ignore),o=r.next();!o.done;o=r.next()){var a=o.value;if(e.startsWith(a))return!0;if(this.is_match&&this.is_match(a,e))return!0;var u=this.cutPath(e,a);if(this.match(a,u))return!0}}catch(t){i={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return!1},t.prototype.getSubscribedListeners=function(t,e,n,r,a){var u,h,d=this;void 0===r&&(r="update"),void 0===a&&(a=null),n=i({},l,n);var c={},f=function(i,o){var u,h;if(c[i]={single:[],bulk:[],bulkData:[]},o.match(t)){var l=o.paramsInfo?p.getParams(o.paramsInfo,t):void 0,f=p.cutPath(t,i),v=o.isRecursive||o.isWildcard?function(){return d.get(f)}:function(){return e},m=[{value:v,path:t,params:l}];try{for(var g=(u=void 0,s(o.listeners.values())),y=g.next();!y.done;y=g.next()){var b=y.value;p.shouldIgnore(b,t)||(b.options.bulk?c[i].bulk.push({listener:b,listenersCollection:o,eventInfo:{type:r,listener:b,path:{listener:i,update:a||t,resolved:void 0},params:l,options:n},value:m}):c[i].single.push({listener:b,listenersCollection:o,eventInfo:{type:r,listener:b,path:{listener:i,update:a||t,resolved:p.cleanNotRecursivePath(t)},params:l,options:n},value:v}))}}catch(t){u={error:t}}finally{try{y&&!y.done&&(h=g.return)&&h.call(g)}finally{if(u)throw u.error}}}},p=this;try{for(var v=s(this.listeners),m=v.next();!m.done;m=v.next()){var g=o(m.value,2);f(g[0],g[1])}}catch(t){u={error:t}}finally{try{m&&!m.done&&(h=v.return)&&h.call(v)}finally{if(u)throw u.error}}return c},t.prototype.notifySubscribedListeners=function(t,e,i,n,r){return void 0===n&&(n="update"),void 0===r&&(r=null),this.notifyListeners(this.getSubscribedListeners(t,e,i,n,r))},t.prototype.getNestedListeners=function(t,e,i,n,r){var a,u;void 0===n&&(n="update"),void 0===r&&(r=null);var h={},l=function(a,u){h[a]={single:[],bulk:[]};var l=d.cutPath(a,t);if(d.match(l,t)){var c=d.trimPath(a.substr(l.length)),f=new $.default(e,d.options.delimiter,d.options.wildcard).get(c),p=u.paramsInfo?d.getParams(u.paramsInfo,t):void 0,v=[],m={},g=function(e){var l,c,g=function(){return f[e]},y=[t,e].join(d.options.delimiter);try{for(var b=(l=void 0,s(u.listeners)),w=b.next();!w.done;w=b.next()){var _=o(w.value,2),D=_[0],M=_[1],x={type:n,listener:M,listenersCollection:u,path:{listener:a,update:r||t,resolved:d.cleanNotRecursivePath(y)},params:p,options:i};d.shouldIgnore(M,t)||(M.options.bulk?(v.push({value:g,path:y,params:p}),m[D]=M):h[a].single.push({listener:M,listenersCollection:u,eventInfo:x,value:g}))}}catch(t){l={error:t}}finally{try{w&&!w.done&&(c=b.return)&&c.call(b)}finally{if(l)throw l.error}}};for(var y in f)g(y);for(var b in m){var w=m[b],_={type:n,listener:w,listenersCollection:u,path:{listener:a,update:t,resolved:void 0},options:i,params:p};h[a].bulk.push({listener:w,listenersCollection:u,eventInfo:_,value:v})}}},d=this;try{for(var c=s(this.listeners),f=c.next();!f.done;f=c.next()){var p=o(f.value,2);l(p[0],p[1])}}catch(t){a={error:t}}finally{try{f&&!f.done&&(u=c.return)&&u.call(c)}finally{if(a)throw a.error}}return h},t.prototype.notifyNestedListeners=function(t,e,i,n,r,s){return void 0===n&&(n="update"),void 0===s&&(s=null),this.notifyListeners(this.getNestedListeners(t,e,i,n,s),r,!1)},t.prototype.getNotifyOnlyListeners=function(t,e,i,n,r){var a,u;void 0===n&&(n="update"),void 0===r&&(r=null);var h={};if("object"!=typeof i.only||!Array.isArray(i.only)||void 0===i.only[0]||!this.canBeNested(e))return h;var l=function(a){var u=new $.default(e,d.options.delimiter,d.options.wildcard).get(a);h[a]={bulk:[],single:[]};var l=function(e){var l,c,f,p,v=t+d.options.delimiter+e;try{for(var m=(l=void 0,s(d.listeners)),g=m.next();!g.done;g=m.next()){var y=o(g.value,2),b=y[0],w=y[1],_=w.paramsInfo?d.getParams(w.paramsInfo,v):void 0;if(d.match(b,v)){var D=function(){return u[e]},M=[{value:D,path:v,params:_}],x=function(e){var s={type:n,listener:e,listenersCollection:w,path:{listener:b,update:r||t,resolved:d.cleanNotRecursivePath(v)},params:_,options:i};if(d.shouldIgnore(e,t))return"continue";e.options.bulk?h[a].bulk.some((function(t){return t.listener===e}))||h[a].bulk.push({listener:e,listenersCollection:w,eventInfo:s,value:M}):h[a].single.push({listener:e,listenersCollection:w,eventInfo:s,value:D})};try{for(var $=(f=void 0,s(w.listeners.values())),O=$.next();!O.done;O=$.next()){x(O.value)}}catch(t){f={error:t}}finally{try{O&&!O.done&&(p=$.return)&&p.call($)}finally{if(f)throw f.error}}}}}catch(t){l={error:t}}finally{try{g&&!g.done&&(c=m.return)&&c.call(m)}finally{if(l)throw l.error}}};for(var c in u)l(c)},d=this;try{for(var c=s(i.only),f=c.next();!f.done;f=c.next()){l(f.value)}}catch(t){a={error:t}}finally{try{f&&!f.done&&(u=c.return)&&u.call(c)}finally{if(a)throw a.error}}return h},t.prototype.notifyOnly=function(t,e,i,n,r){return void 0===n&&(n="update"),void 0===r&&(r=""),void 0!==this.notifyListeners(this.getNotifyOnlyListeners(t,e,i,n,r))[0]},t.prototype.canBeNested=function(t){return"object"==typeof t&&null!==t},t.prototype.getUpdateValues=function(t,e,i){var n=i;return"function"==typeof i&&(n=i(this.pathGet(e,this.data))),{newValue:n,oldValue:t}},t.prototype.wildcardNotify=function(t,e){var i,n,r,o,a,u,h=[];try{for(var l=s(t),d=l.next();!d.done;d=l.next()){var c=d.value,f=this.notifyListeners(c,h);try{for(var p=(r=void 0,s(f)),v=p.next();!v.done;v=p.next()){var m=v.value;h.push(m)}}catch(t){r={error:t}}finally{try{v&&!v.done&&(o=p.return)&&o.call(p)}finally{if(r)throw r.error}}}}catch(t){i={error:t}}finally{try{d&&!d.done&&(n=l.return)&&n.call(l)}finally{if(i)throw i.error}}try{for(var g=s(e),y=g.next();!y.done;y=g.next()){var b=y.value;this.executeWaitingListeners(b)}}catch(t){a={error:t}}finally{try{y&&!y.done&&(u=g.return)&&u.call(g)}finally{if(a)throw a.error}}this.jobsRunning--},t.prototype.wildcardUpdate=function(t,e,n,r){void 0===n&&(n=l),void 0===r&&(r=!1),++this.jobsRunning,n=i({},l,n);var s=this.scan.get(t),o={};for(var a in s){var u=this.split(a),h=this.getUpdateValues(s[a],u,e),d=h.oldValue,c=h.newValue;this.same(c,d)&&!n.force||(this.pathSet(u,c,this.data),o[a]=c)}var f=[],p=[];for(var a in o){c=o[a];n.only.length?f.push(this.getNotifyOnlyListeners(a,c,n,"update",t)):(f.push(this.getSubscribedListeners(a,c,n,"update",t)),this.canBeNested(c)&&f.push(this.getNestedListeners(a,c,n,"update",t))),n.debug&&this.options.log("Wildcard update",{path:a,newValue:c}),p.push(a)}if(r){var v=this;return function(){return v.wildcardNotify(f,p)}}this.wildcardNotify(f,p)},t.prototype.runUpdateQueue=function(){if(!this.destroyed)for(;this.updateQueue.length&&this.updateQueue.length<this.options.maxSimultaneousJobs;){var t=this.updateQueue.shift();t.options.queue=!1,this.update(t.updatePath,t.fnOrValue,t.options,t.multi)}},t.prototype.updateNotify=function(t,e,i){var n=this.notifySubscribedListeners(t,e,i);this.canBeNested(e)&&this.notifyNestedListeners(t,e,i,"update",n),this.executeWaitingListeners(t)},t.prototype.updateNotifyOnly=function(t,e,i){this.notifyOnly(t,e,i),this.executeWaitingListeners(t)},t.prototype.update=function(t,e,n,r){var s=this;if(void 0===n&&(n=i({},l)),void 0===r&&(r=!1),!this.destroyed){var o=this.jobsRunning;if((this.options.queue||n.queue)&&o){if(o>this.options.maxSimultaneousJobs)throw new Error("Maximal simultaneous jobs limit reached.");this.updateQueue.push({updatePath:t,fnOrValue:e,options:n,multi:r});var a=Promise.resolve().then((function(){s.runUpdateQueue()}));return r?function(){return a}:a}if(this.isWildcard(t))return this.wildcardUpdate(t,e,n,r);++this.jobsRunning;var u=this.split(t),h=this.getUpdateValues(this.pathGet(u,this.data),u,e),d=h.oldValue,c=h.newValue;if(n.debug&&this.options.log("Updating "+t+" "+(n.source?"from "+n.source:""),{oldValue:d,newValue:c}),this.same(c,d)&&!n.force)return--this.jobsRunning,r?function(){return c}:c;if(this.pathSet(u,c,this.data),null===(n=i({},l,n)).only)return--this.jobsRunning,r?function(){}:c;if(n.only.length){if(--this.jobsRunning,r){var f=this;return function(){return f.updateNotifyOnly(t,c,n)}}return this.updateNotifyOnly(t,c,n),c}if(r){--this.jobsRunning;var p=this;return function(){return p.updateNotify(t,c,n)}}return this.updateNotify(t,c,n),--this.jobsRunning,c}},t.prototype.multi=function(){if(this.destroyed)return{update:function(){},done:function(){}};var t=this,e=[];return{update:function(i,n,r){return void 0===r&&(r=l),e.push(t.update(i,n,r,!0)),this},done:function(){for(var t=0,i=e.length;t<i;t++)e[t]();e.length=0}}},t.prototype.get=function(t){if(void 0===t&&(t=void 0),!this.destroyed)return void 0===t||""===t?this.data:this.pathGet(this.split(t),this.data)},t.prototype.last=function(t){var e=this,i=this.lastExecs.get(t);i||(i={calls:0},this.lastExecs.set(t,i));var n=++i.calls;this.resolved.then((function(){n===i.calls&&(e.lastExecs.set(t,{calls:0}),t())}))},t.prototype.isMuted=function(t){var e,i;if(!this.options.useMute)return!1;try{for(var n=s(this.muted),r=n.next();!r.done;r=n.next()){var o=r.value;if(this.match(t,o))return!0;if(this.match(o,t))return!0}}catch(t){e={error:t}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}return!1},t.prototype.mute=function(t){this.muted.add(t)},t.prototype.unmute=function(t){this.muted.delete(t)},t.prototype.debugSubscribe=function(t,e,i){t.options.debug&&this.options.log("listener subscribed",{listenerPath:i,listener:t,listenersCollection:e})},t.prototype.debugListener=function(t,e){(e.eventInfo.options.debug||e.listener.options.debug)&&this.options.log("Listener fired",{time:Date.now()-t,info:e})},t.prototype.debugTime=function(t){return t.listener.options.debug||t.eventInfo.options.debug?Date.now():0},t}();e.default=d}));
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
String(Math.random()).slice(2),document.createComment(""),window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:t=>t}),document.createElement("template"),document.createTextNode("");let W=!1;(()=>{try{const t={get capture(){return W=!0,!1}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){}})(),
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.3.0")
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */;
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
document.createElement("template"),document.createTextNode("");const j=function(t,e=""){let i="gstc__"+t;return"gstc"===t&&(i="gstc"),e?`${i} ${i}--${e.replace(":","-")}`:i}("chart-timeline-items-row-item-resizing-handle-content-line");class N{constructor(t,e){this.onDestroy=[],this.vido=t,this.state=t.state,this.api=t.api,this.data=function(t={}){const e={onStart:({items:t})=>t.after,onResize:({items:t})=>t.after,onEnd:({items:t})=>t.after},i={start:({startTime:t,time:e})=>t.startOf(e.period),end:({endTime:t,time:e})=>t.endOf(e.period)},n={width:18,horizontalMargin:0,verticalMargin:0,outside:!1,outsideWidth:14,outsideHorizontalMargin:6,onlyWhenSelected:!0},r=Object.assign({enabled:!0,dependant:!0,debug:!1,state:"",content:null,bodyClass:"gstc-items-resizing",bodyClassLeft:"gstc-items-resizing-left",bodyClassRight:"gstc-items-resizing-right",outsideWidthThreshold:100,initialPosition:{x:0,y:0},currentPosition:{x:0,y:0},movement:{px:0,time:0},initialItems:[],initialDependant:[],initialItemsData:{},initialDependantData:{},targetData:null,leftIsMoving:!1,rightIsMoving:!1,handle:Object.assign({},n),events:Object.assign({},e),snapToTime:Object.assign({},i)},t);return t.snapToTime&&(r.snapToTime=Object.assign(Object.assign({},i),t.snapToTime)),t.events&&(r.events=Object.assign(Object.assign({},e),t.events)),t.handle&&(r.handle=Object.assign(Object.assign({},n),t.handle)),r}(e),this.html=t.html,this.data.content||(this.data.content=this.html`<div class=${j}></div><div class=${j}></div>`),this.innerSlot=this.innerSlot.bind(this),this.onRightPointerDown=this.onRightPointerDown.bind(this),this.onRightPointerMove=t.schedule(this.onRightPointerMove.bind(this)),this.onRightPointerUp=this.onRightPointerUp.bind(this),this.onLeftPointerDown=this.onLeftPointerDown.bind(this),this.onLeftPointerMove=t.schedule(this.onLeftPointerMove.bind(this)),this.onLeftPointerUp=this.onLeftPointerUp.bind(this),this.destroy=this.destroy.bind(this),this.updateData(),this.onDestroy.push(this.state.subscribe("config.plugin.ItemResizing",t=>{t.enabled?document.body.classList.add(t.bodyClass):document.body.classList.remove(t.bodyClass),this.data=t})),document.addEventListener("pointermove",this.onLeftPointerMove),document.addEventListener("pointermove",this.onRightPointerMove),document.addEventListener("pointerup",this.onLeftPointerUp),document.addEventListener("pointerup",this.onRightPointerUp),this.state.update("config.slots.chart-timeline-items-row-item.inner",t=>(t.includes(this.innerSlot)||t.push(this.innerSlot),t))}destroy(){this.onDestroy.forEach(t=>t()),document.removeEventListener("pointermove",this.onLeftPointerMove),document.removeEventListener("pointerup",this.onLeftPointerUp),document.removeEventListener("pointermove",this.onRightPointerMove),document.removeEventListener("pointerup",this.onRightPointerUp),this.state.update("config.slots.chart-timeline-items-row-item.inner",t=>t.filter(t=>t!==this.innerSlot))}updateData(){this.state.update("config.plugin.ItemResizing",this.data)}setUpClasses(t=!1){this.leftClassName=this.api.getClass("chart-timeline-items-row-item-resizing-handle"),this.leftClassName+=" "+this.leftClassName+"--left",this.rightClassName=this.api.getClass("chart-timeline-items-row-item-resizing-handle"),this.rightClassName+=" "+this.rightClassName+"--right",t&&(this.leftClassName+=` ${this.api.getClass("chart-timeline-items-row-item-resizing-handle")}--left-outside`,this.rightClassName+=` ${this.api.getClass("chart-timeline-items-row-item-resizing-handle")}--right-outside`)}getSelectedItems(){return this.state.get("config.plugin.Selection.selected.chart-timeline-items-row-item").map(t=>this.api.mergeDeep({},this.api.getItem(t)))}getSelectedItemsData(t){const e={};for(const i of t)e[i.id]=this.api.mergeDeep({},this.api.getItemData(i.id));return e}getRightStyleMap(t){const e=new this.vido.StyleMap({}),i=this.api.getItemData(t.id);return e.style.top="0px",this.data.handle.outside||i.actualWidth<this.data.outsideWidthThreshold?(e.style.position="absolute",e.style.right=-(this.data.handle.outsideWidth+this.data.handle.outsideHorizontalMargin)+"px",e.style.width=this.data.handle.outsideWidth+"px",this.setUpClasses(!0)):(e.style.position="static",e.style.width=this.data.handle.width+"px",this.setUpClasses(!1)),e.style.height=i.actualHeight-2*this.data.handle.verticalMargin+"px",i.position.right!==i.position.actualRight&&(e.style.display="none"),e}getLeftStyleMap(t){const e=new this.vido.StyleMap({}),i=this.api.getItemData(t.id);return e.style.top="0px",this.data.handle.outside||i.actualWidth<this.data.outsideWidthThreshold?(e.style.position="absolute",e.style.left=-(this.data.handle.outsideWidth+this.data.handle.outsideHorizontalMargin)+"px",e.style.width=this.data.handle.outsideWidth+"px",this.setUpClasses(!0)):(e.style.position="static",e.style.left=this.data.handle.horizontalMargin+"px",e.style.width=this.data.handle.width+"px",this.setUpClasses(!1)),e.style.height=i.actualHeight-2*this.data.handle.verticalMargin+"px",i.position.left!==i.position.actualLeft&&(e.style.display="none"),e}getEventArgument(t){const e=this.api.getAllItems(),i=[];for(const n of t)i.push(this.api.mergeDeep({},e[n.id]));return{items:{initial:this.data.initialItems,before:i,after:t,targetData:this.data.targetData},vido:this.vido,state:this.state,time:this.state.get("$data.chart.time")}}getDependantItems(){const t=[],e=this.api.getItemsData();for(const i of this.data.initialItems)for(const n of e[i.id].dependant)t.includes(n)||t.push(n);const i=this.state.get("config.chart.items");return t.map(t=>i[t]).map(t=>this.api.mergeDeep({},t))}getDependantItemsData(){const t={},e=this.api.getItemsData();for(const i of this.data.initialDependant)t[i.id]=this.api.mergeDeep({},e[i.id]);return t}moveDependantItems(t,e){if(!this.data.dependant)return e;const i=this.api.getItemsData(),n=this.state.get("config.chart.time");for(const r of t){const t=this.data.initialItems.find(t=>t.id===r.id),s=this.data.initialItemsData[t.id],o=i[r.id];if(o.dependant.length)for(const t of o.dependant){const i=this.data.initialDependant.find(e=>e.id===t),r=this.data.initialDependantData[t],a=o.time.endDate.diff(s.time.endDate,"millisecond"),u=r.time.startDate.add(a,"millisecond"),h=r.time.endDate.add(a,"millisecond"),l=o.position.right-r.position.right,d=this.data.snapToTime.start({startTime:u,item:this.api.mergeDeep({},i),time:n,movement:{px:l,time:a},vido:this.vido}),c=this.data.snapToTime.end({endTime:h,item:this.api.mergeDeep({},i),time:n,movement:{px:l,time:a},vido:this.vido});e=(e=e.update(`config.chart.items.${t}.time`,t=>(t.start=d.valueOf(),t.end=c.valueOf(),t))).update(`$data.chart.items.${t}.time`,t=>(t.startDate=d,t.endDate=c,t))}}return e}dispatchEvent(t,e,i=null){"onStart"===t&&(this.api.muteMethod("fixOverlapped"),this.state.mute("config.chart.items.*.time")),"onEnd"===t&&(this.api.unmuteMethod("fixOverlapped"),this.state.unmute("config.chart.items.*.time")),e=e.map(t=>this.api.mergeDeep({},t));const n=this.data.events[t](this.getEventArgument(e));let r=this.state.multi();for(const t of n)r=r.update(`config.chart.items.${t.id}.time`,t.time),i&&(r=r.update("$data.chart.items."+t.id,e=>(e.time=Object.assign(Object.assign({},e.time),i[t.id].time),e.position=Object.assign(Object.assign({},e.position),i[t.id].position),e)));"onStart"!==t&&"onResize"!==t||(r=this.moveDependantItems(n,r)),r.done()}getItemsForDiff(){const t=this.getSelectedItems()[0],e=this.data.initialItems.find(e=>e.id===t.id);return{modified:t,original:e}}onPointerDown(t){t.preventDefault(),t.stopPropagation(),this.data.initialItems=this.getSelectedItems(),this.data.initialDependant=this.getDependantItems(),this.data.initialItemsData=this.getSelectedItemsData(this.data.initialItems),this.data.initialDependantData=this.getDependantItemsData(),this.data.targetData=this.api.mergeDeep({},t.target.vido),this.data.initialPosition={x:t.screenX,y:t.screenY},this.data.currentPosition=Object.assign({},this.data.initialPosition),""!==this.data.state&&"end"!==this.data.state||(this.data.state="resize"),this.dispatchEvent("onStart",this.data.initialItems)}onLeftPointerDown(t){this.data.enabled&&(document.body.classList.add(this.data.bodyClassLeft),this.onPointerDown(t),this.data.leftIsMoving=!0,this.updateData())}onRightPointerDown(t){this.data.enabled&&(document.body.classList.add(this.data.bodyClassRight),this.onPointerDown(t),this.data.rightIsMoving=!0,this.updateData())}onPointerMove(t){t.stopPropagation(),t.preventDefault(),this.data.currentPosition.x=t.screenX,this.data.currentPosition.y=t.screenY,this.data.movement.px=this.data.currentPosition.x-this.data.initialPosition.x;const{original:e,modified:i}=this.getItemsForDiff();this.data.movement.time=i.time.start-e.time.start,"resize"!==this.data.state&&"start"!==this.data.state||(this.data.state="resize")}onLeftPointerMove(t){if(!this.data.enabled||!this.data.leftIsMoving)return;this.onPointerMove(t);const e=this.getSelectedItems(),i={},n=this.data.movement,r=this.state.get("$data.chart.time");for(let t=0,s=e.length;t<s;t++){const s=e[t],o=this.api.mergeDeep({},this.data.initialItemsData[s.id]);o.position.left=o.position.left+n.px,o.position.left>o.position.right-s.minWidth&&(o.position.left=o.position.right-s.minWidth);const a=this.api.time.getTimeFromViewOffsetPx(o.position.left,r,!0);o.width=o.position.right-o.position.left,o.width<s.minWidth&&(o.width=s.minWidth),o.actualWidth=o.width;const u=this.data.snapToTime.start({startTime:this.api.time.date(a),item:s,time:r,movement:n,vido:this.vido});s.time.start=u.valueOf(),o.time.startDate=u,i[s.id]=o}this.dispatchEvent("onResize",e,i),this.updateData()}onRightPointerMove(t){if(!this.data.enabled||!this.data.rightIsMoving)return;this.onPointerMove(t);const e=this.getSelectedItems(),i={},n=this.data.movement,r=this.state.get("$data.chart.time");for(let t=0,s=e.length;t<s;t++){const s=e[t],o=this.api.mergeDeep({},this.data.initialItemsData[s.id]);o.position.right=o.position.right+n.px,o.position.right<o.position.left+s.minWidth&&(o.position.right=o.position.left+s.minWidth);const a=this.api.time.getTimeFromViewOffsetPx(o.position.right,r,!1);o.width=o.position.right-o.position.left,o.width<s.minWidth&&(o.width=s.minWidth),o.actualWidth=o.width;const u=this.data.snapToTime.end({endTime:this.api.time.date(a),item:s,time:r,movement:n,vido:this.vido});s.time.end=u.valueOf(),o.time.endDate=u,i[s.id]=o}this.dispatchEvent("onResize",e,i),this.updateData()}onEnd(){const t=this.getSelectedItems();this.dispatchEvent("onEnd",t)}onPointerUp(t){t.preventDefault(),t.stopPropagation(),"resize"===this.data.state&&(this.data.state="end")}onLeftPointerUp(t){document.body.classList.remove(this.data.bodyClassLeft),this.data.enabled&&this.data.leftIsMoving&&(this.data.leftIsMoving=!1,this.onPointerUp(t),this.onEnd(),this.updateData())}onRightPointerUp(t){document.body.classList.remove(this.data.bodyClassRight),this.data.enabled&&this.data.rightIsMoving&&(this.data.rightIsMoving=!1,this.onPointerUp(t),this.onEnd(),this.updateData())}innerSlot(t,e){let i,n,r;const s={handleEvent:t=>this.onLeftPointerDown(t),capture:!0},o={handleEvent:t=>this.onRightPointerDown(t),capture:!0};return t.onChange(t=>{const e=t.item;i=!this.api.getItemData(e.id).detached,this.data.handle.onlyWhenSelected&&(i=i&&e.selected);const a=this.getRightStyleMap(e),u=this.getLeftStyleMap(e);n=this.html`<div class=${this.leftClassName} style=${u} @pointerdown=${s}>${this.data.content}</div>`,r=this.html`<div class=${this.rightClassName} style=${a} @pointerdown=${o}>${this.data.content}</div>`}),t=>this.html`${i?n:null}${t}${i?r:null}`}}function A(t={}){return function(e){const i=e.state.get("config.plugin.ItemResizing");i&&(t=e.api.mergeDeep({},t,i));return new N(e,t).destroy}}export{A as Plugin};
